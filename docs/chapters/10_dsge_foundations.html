<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.27">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>DSGE Foundations – Mastering Empirical Macroeconometrics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/11_dsge_estimation.html" rel="next">
<link href="../chapters/09_bayesian_panel.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-f555ed0e695c0487cf72966c0b30f9ff.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-ec3f846469679b9e6f6b146d88a0bba5.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/10_dsge_foundations.html">Phase 5: Structural Macro</a></li><li class="breadcrumb-item"><a href="../chapters/10_dsge_foundations.html"><span class="chapter-title">DSGE Foundations</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Mastering Empirical Macroeconometrics</a> 
        <div class="sidebar-tools-main">
    <a href="https://github.com/bijoyratanghosh/empirical-macro-curriculum" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Mastering Empirical Macroeconometrics</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Phase 1: Foundations</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/01_panel_econometrics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Panel Data Econometrics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/02_identification.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Identification in Macroeconomics</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Phase 2: Dynamic Methods</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/03_local_projections.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Local Projections</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/04_var_svar.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Vector Autoregressions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Phase 3: Treatment Effects</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/05_staggered_did.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Staggered Difference-in-Differences</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/06_synthetic_control.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Synthetic Control Methods</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Phase 4: Bayesian Econometrics</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/07_bayesian_foundations.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Bayesian Foundations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/08_bayesian_var.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Bayesian Vector Autoregressions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/09_bayesian_panel.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Bayesian Panel Methods</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Phase 5: Structural Macro</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/10_dsge_foundations.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">DSGE Foundations</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/11_dsge_estimation.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">DSGE Estimation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">Phase 6: Causal Machine Learning</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/12_regularization.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Regularization for Macro</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/13_causal_ml.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Causal Machine Learning</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../references.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#what-is-a-dsge-model" id="toc-what-is-a-dsge-model" class="nav-link active" data-scroll-target="#what-is-a-dsge-model">What is a DSGE Model?</a>
  <ul class="collapse">
  <li><a href="#from-micro-to-macro" id="toc-from-micro-to-macro" class="nav-link" data-scroll-target="#from-micro-to-macro">From Micro to Macro</a></li>
  <li><a href="#the-general-form" id="toc-the-general-form" class="nav-link" data-scroll-target="#the-general-form">The General Form</a></li>
  </ul></li>
  <li><a href="#the-rbc-core" id="toc-the-rbc-core" class="nav-link" data-scroll-target="#the-rbc-core">The RBC Core</a>
  <ul class="collapse">
  <li><a href="#household-problem" id="toc-household-problem" class="nav-link" data-scroll-target="#household-problem">Household Problem</a>
  <ul class="collapse">
  <li><a href="#first-order-conditions" id="toc-first-order-conditions" class="nav-link" data-scroll-target="#first-order-conditions">First-Order Conditions</a></li>
  <li><a href="#example-log-utility" id="toc-example-log-utility" class="nav-link" data-scroll-target="#example-log-utility">Example: Log Utility</a></li>
  </ul></li>
  <li><a href="#firm-problem" id="toc-firm-problem" class="nav-link" data-scroll-target="#firm-problem">Firm Problem</a></li>
  <li><a href="#market-clearing" id="toc-market-clearing" class="nav-link" data-scroll-target="#market-clearing">Market Clearing</a></li>
  <li><a href="#the-complete-rbc-model" id="toc-the-complete-rbc-model" class="nav-link" data-scroll-target="#the-complete-rbc-model">The Complete RBC Model</a></li>
  </ul></li>
  <li><a href="#the-new-keynesian-model" id="toc-the-new-keynesian-model" class="nav-link" data-scroll-target="#the-new-keynesian-model">The New Keynesian Model</a>
  <ul class="collapse">
  <li><a href="#the-3-equation-nk-model" id="toc-the-3-equation-nk-model" class="nav-link" data-scroll-target="#the-3-equation-nk-model">The 3-Equation NK Model</a>
  <ul class="collapse">
  <li><a href="#is-curve-dynamic-is" id="toc-is-curve-dynamic-is" class="nav-link" data-scroll-target="#is-curve-dynamic-is">1. IS Curve (Dynamic IS)</a></li>
  <li><a href="#phillips-curve-nkpc" id="toc-phillips-curve-nkpc" class="nav-link" data-scroll-target="#phillips-curve-nkpc">2. Phillips Curve (NKPC)</a></li>
  <li><a href="#taylor-rule" id="toc-taylor-rule" class="nav-link" data-scroll-target="#taylor-rule">3. Taylor Rule</a></li>
  </ul></li>
  <li><a href="#deriving-the-phillips-curve" id="toc-deriving-the-phillips-curve" class="nav-link" data-scroll-target="#deriving-the-phillips-curve">Deriving the Phillips Curve</a>
  <ul class="collapse">
  <li><a href="#calvo-pricing-setup" id="toc-calvo-pricing-setup" class="nav-link" data-scroll-target="#calvo-pricing-setup">Calvo Pricing Setup</a></li>
  <li><a href="#optimal-price-setting" id="toc-optimal-price-setting" class="nav-link" data-scroll-target="#optimal-price-setting">Optimal Price Setting</a></li>
  <li><a href="#aggregating-to-the-phillips-curve" id="toc-aggregating-to-the-phillips-curve" class="nav-link" data-scroll-target="#aggregating-to-the-phillips-curve">Aggregating to the Phillips Curve</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#log-linearization" id="toc-log-linearization" class="nav-link" data-scroll-target="#log-linearization">Log-Linearization</a>
  <ul class="collapse">
  <li><a href="#the-technique" id="toc-the-technique" class="nav-link" data-scroll-target="#the-technique">The Technique</a>
  <ul class="collapse">
  <li><a href="#key-approximation" id="toc-key-approximation" class="nav-link" data-scroll-target="#key-approximation">Key Approximation</a></li>
  <li><a href="#example-euler-equation" id="toc-example-euler-equation" class="nav-link" data-scroll-target="#example-euler-equation">Example: Euler Equation</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#solving-rational-expectations-models" id="toc-solving-rational-expectations-models" class="nav-link" data-scroll-target="#solving-rational-expectations-models">Solving Rational Expectations Models</a>
  <ul class="collapse">
  <li><a href="#partitioning-the-system" id="toc-partitioning-the-system" class="nav-link" data-scroll-target="#partitioning-the-system">Partitioning the System</a></li>
  <li><a href="#blanchard-kahn-conditions" id="toc-blanchard-kahn-conditions" class="nav-link" data-scroll-target="#blanchard-kahn-conditions">Blanchard-Kahn Conditions</a></li>
  <li><a href="#the-solution-form" id="toc-the-solution-form" class="nav-link" data-scroll-target="#the-solution-form">The Solution Form</a></li>
  <li><a href="#common-causes-of-bk-violations" id="toc-common-causes-of-bk-violations" class="nav-link" data-scroll-target="#common-causes-of-bk-violations">Common Causes of BK Violations</a></li>
  <li><a href="#numerical-solution-qz-decomposition" id="toc-numerical-solution-qz-decomposition" class="nav-link" data-scroll-target="#numerical-solution-qz-decomposition">Numerical Solution: QZ Decomposition</a></li>
  </ul></li>
  <li><a href="#calibration" id="toc-calibration" class="nav-link" data-scroll-target="#calibration">Calibration</a>
  <ul class="collapse">
  <li><a href="#standard-rbcnk-calibration" id="toc-standard-rbcnk-calibration" class="nav-link" data-scroll-target="#standard-rbcnk-calibration">Standard RBC/NK Calibration</a></li>
  <li><a href="#matching-moments" id="toc-matching-moments" class="nav-link" data-scroll-target="#matching-moments">Matching Moments</a></li>
  <li><a href="#steady-state-relationships" id="toc-steady-state-relationships" class="nav-link" data-scroll-target="#steady-state-relationships">Steady-State Relationships</a></li>
  </ul></li>
  <li><a href="#dynare-basics" id="toc-dynare-basics" class="nav-link" data-scroll-target="#dynare-basics">Dynare Basics</a>
  <ul class="collapse">
  <li><a href="#a-simple-rbc-model-in-dynare" id="toc-a-simple-rbc-model-in-dynare" class="nav-link" data-scroll-target="#a-simple-rbc-model-in-dynare">A Simple RBC Model in Dynare</a></li>
  <li><a href="#key-dynare-commands" id="toc-key-dynare-commands" class="nav-link" data-scroll-target="#key-dynare-commands">Key Dynare Commands</a></li>
  <li><a href="#important-timing-convention" id="toc-important-timing-convention" class="nav-link" data-scroll-target="#important-timing-convention">Important Timing Convention</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  <li><a href="#key-references" id="toc-key-references" class="nav-link" data-scroll-target="#key-references">Key References</a>
  <ul class="collapse">
  <li><a href="#foundational" id="toc-foundational" class="nav-link" data-scroll-target="#foundational">Foundational</a></li>
  <li><a href="#medium-scale-models" id="toc-medium-scale-models" class="nav-link" data-scroll-target="#medium-scale-models">Medium-Scale Models</a></li>
  <li><a href="#solution-methods" id="toc-solution-methods" class="nav-link" data-scroll-target="#solution-methods">Solution Methods</a></li>
  <li><a href="#calibration-1" id="toc-calibration-1" class="nav-link" data-scroll-target="#calibration-1">Calibration</a></li>
  <li><a href="#software" id="toc-software" class="nav-link" data-scroll-target="#software">Software</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/bijoyratanghosh/empirical-macro-curriculum/edit/main/chapters/10_dsge_foundations.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/bijoyratanghosh/empirical-macro-curriculum/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/10_dsge_foundations.html">Phase 5: Structural Macro</a></li><li class="breadcrumb-item"><a href="../chapters/10_dsge_foundations.html"><span class="chapter-title">DSGE Foundations</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-title">DSGE Foundations</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
<p class="subtitle lead">Microfoundations, the New Keynesian Model, and Solution Methods</p>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="what-is-a-dsge-model" class="level1 unnumbered">
<h1 class="unnumbered">What is a DSGE Model?</h1>
<p><strong>Dynamic Stochastic General Equilibrium</strong> models are the workhorse of modern macroeconomics. They combine:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Component</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Dynamic</strong></td>
<td>Agents optimize over time, considering future</td>
</tr>
<tr class="even">
<td><strong>Stochastic</strong></td>
<td>Random shocks drive business cycle fluctuations</td>
</tr>
<tr class="odd">
<td><strong>General</strong></td>
<td>All markets (goods, labor, capital) interact</td>
</tr>
<tr class="even">
<td><strong>Equilibrium</strong></td>
<td>Supply equals demand in every market</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Note</span>The Core Philosophy
</div>
</div>
<div class="callout-body-container callout-body">
<p>DSGE models are <strong>microfounded</strong>: aggregate behavior emerges from explicit optimization by households, firms, and policymakers. No ad hoc aggregate relationships.</p>
</div>
</div>
<section id="from-micro-to-macro" class="level2">
<h2 class="anchored" data-anchor-id="from-micro-to-macro">From Micro to Macro</h2>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="10_dsge_foundations_files/figure-html/dsge-structure-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>DSGE model structure</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="the-general-form" class="level2">
<h2 class="anchored" data-anchor-id="the-general-form">The General Form</h2>
<p>All DSGE models can be written as:</p>
<p><span class="math display">\[
\mathbb{E}_t\left[f(y_{t+1}, y_t, y_{t-1}, u_t)\right] = 0
\]</span></p>
<p>where:</p>
<ul>
<li><span class="math inline">\(y_t\)</span> = vector of endogenous variables (output, inflation, interest rate, capital, …)</li>
<li><span class="math inline">\(u_t\)</span> = vector of exogenous shocks (technology, monetary, fiscal, …)</li>
<li><span class="math inline">\(f\)</span> = system of equilibrium conditions (Euler equations, market clearing, …)</li>
<li><span class="math inline">\(\mathbb{E}_t\)</span> = expectation conditional on time-<span class="math inline">\(t\)</span> information</li>
</ul>
<p>The challenge: <strong>solving for <span class="math inline">\(y_t\)</span> as a function of states and shocks</strong>.</p>
</section>
</section>
<section id="the-rbc-core" class="level1 unnumbered">
<h1 class="unnumbered">The RBC Core</h1>
<p>Before New Keynesian elements, we start with the <strong>Real Business Cycle</strong> foundation.</p>
<section id="household-problem" class="level2">
<h2 class="anchored" data-anchor-id="household-problem">Household Problem</h2>
<p>A representative household maximizes expected lifetime utility:</p>
<p><span class="math display">\[
\max_{\{C_t, N_t, K_t\}} \mathbb{E}_0 \sum_{t=0}^{\infty} \beta^t U(C_t, N_t)
\]</span></p>
<p><strong>Subject to budget constraint</strong>: <span class="math display">\[
C_t + K_t = W_t N_t + R_t^K K_{t-1} + \Pi_t - T_t + (1-\delta)K_{t-1}
\]</span></p>
<p>where: - <span class="math inline">\(C_t\)</span> = consumption - <span class="math inline">\(N_t\)</span> = labor supply - <span class="math inline">\(K_t\)</span> = end-of-period capital - <span class="math inline">\(W_t\)</span> = real wage - <span class="math inline">\(R_t^K\)</span> = rental rate on capital - <span class="math inline">\(\delta\)</span> = depreciation rate - <span class="math inline">\(\Pi_t\)</span> = firm profits - <span class="math inline">\(T_t\)</span> = lump-sum taxes</p>
<section id="first-order-conditions" class="level3">
<h3 class="anchored" data-anchor-id="first-order-conditions">First-Order Conditions</h3>
<p><strong>Euler equation</strong> (intertemporal consumption choice): <span class="math display">\[
U_C(C_t, N_t) = \beta \mathbb{E}_t\left[U_C(C_{t+1}, N_{t+1}) \cdot (R_{t+1}^K + 1 - \delta)\right]
\]</span></p>
<p><strong>Labor supply</strong> (consumption-leisure trade-off): <span class="math display">\[
\frac{-U_N(C_t, N_t)}{U_C(C_t, N_t)} = W_t
\]</span></p>
</section>
<section id="example-log-utility" class="level3">
<h3 class="anchored" data-anchor-id="example-log-utility">Example: Log Utility</h3>
<p>With <span class="math inline">\(U(C, N) = \log(C) - \chi \frac{N^{1+\phi}}{1+\phi}\)</span>:</p>
<p><span class="math display">\[
\frac{1}{C_t} = \beta \mathbb{E}_t\left[\frac{1}{C_{t+1}} (R_{t+1}^K + 1 - \delta)\right]
\]</span></p>
<p><span class="math display">\[
\chi N_t^\phi \cdot C_t = W_t
\]</span></p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Illustrate consumption smoothing</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>beta <span class="ot">&lt;-</span> <span class="fl">0.99</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>R_gross <span class="ot">&lt;-</span> <span class="fl">1.02</span>  <span class="co"># gross interest rate</span></span>
<span id="cb1-4"><a href="#cb1-4"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># CRRA coefficient</span></span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co"># For sigma = 1 (log utility): C_t+1/C_t = (beta * R)</span></span>
<span id="cb1-7"><a href="#cb1-7"></a>growth_rate <span class="ot">&lt;-</span> beta <span class="sc">*</span> R_gross</span>
<span id="cb1-8"><a href="#cb1-8"></a></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co"># Simulate consumption path with and without smoothing</span></span>
<span id="cb1-10"><a href="#cb1-10"></a>T_sim <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>income <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="fu">rep</span>(<span class="fl">1.2</span>, <span class="dv">10</span>))  <span class="co"># income jumps at t=10</span></span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co"># Without smoothing (hand-to-mouth)</span></span>
<span id="cb1-14"><a href="#cb1-14"></a>c_htm <span class="ot">&lt;-</span> income</span>
<span id="cb1-15"><a href="#cb1-15"></a></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="co"># With smoothing (optimal)</span></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co"># Permanent income = average</span></span>
<span id="cb1-18"><a href="#cb1-18"></a>perm_inc <span class="ot">&lt;-</span> <span class="fu">mean</span>(income)</span>
<span id="cb1-19"><a href="#cb1-19"></a>c_smooth <span class="ot">&lt;-</span> <span class="fu">rep</span>(perm_inc, T_sim)</span>
<span id="cb1-20"><a href="#cb1-20"></a></span>
<span id="cb1-21"><a href="#cb1-21"></a>consumption_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb1-22"><a href="#cb1-22"></a>  <span class="at">t =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>T_sim, <span class="dv">2</span>),</span>
<span id="cb1-23"><a href="#cb1-23"></a>  <span class="at">consumption =</span> <span class="fu">c</span>(c_htm, c_smooth),</span>
<span id="cb1-24"><a href="#cb1-24"></a>  <span class="at">type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Hand-to-mouth"</span>, <span class="st">"Euler optimal"</span>), <span class="at">each =</span> T_sim)</span>
<span id="cb1-25"><a href="#cb1-25"></a>)</span>
<span id="cb1-26"><a href="#cb1-26"></a></span>
<span id="cb1-27"><a href="#cb1-27"></a><span class="fu">ggplot</span>(consumption_df, <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> consumption, <span class="at">color =</span> type, <span class="at">linetype =</span> type)) <span class="sc">+</span></span>
<span id="cb1-28"><a href="#cb1-28"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb1-29"><a href="#cb1-29"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">10</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb1-30"><a href="#cb1-30"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">10.5</span>, <span class="at">y =</span> <span class="fl">1.15</span>, <span class="at">label =</span> <span class="st">"Income jump"</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb1-31"><a href="#cb1-31"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#e74c3c"</span>, <span class="st">"#3498db"</span>)) <span class="sc">+</span></span>
<span id="cb1-32"><a href="#cb1-32"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Consumption Smoothing via the Euler Equation"</span>,</span>
<span id="cb1-33"><a href="#cb1-33"></a>       <span class="at">subtitle =</span> <span class="st">"Optimal: smooth consumption; Suboptimal: track income"</span>,</span>
<span id="cb1-34"><a href="#cb1-34"></a>       <span class="at">x =</span> <span class="st">"Period"</span>, <span class="at">y =</span> <span class="st">"Consumption"</span>, <span class="at">color =</span> <span class="cn">NULL</span>, <span class="at">linetype =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb1-35"><a href="#cb1-35"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb1-36"><a href="#cb1-36"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="10_dsge_foundations_files/figure-html/euler-intuition-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Euler equation: optimal consumption smoothing</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="firm-problem" class="level2">
<h2 class="anchored" data-anchor-id="firm-problem">Firm Problem</h2>
<p>A representative firm maximizes profits with Cobb-Douglas production:</p>
<p><span class="math display">\[
Y_t = A_t K_{t-1}^\alpha N_t^{1-\alpha}
\]</span></p>
<p><strong>Factor demands</strong> (competitive markets, firms are price-takers): <span class="math display">\[
W_t = (1-\alpha) \frac{Y_t}{N_t}
\]</span> <span class="math display">\[
R_t^K = \alpha \frac{Y_t}{K_{t-1}}
\]</span></p>
<p><strong>Technology shock</strong> follows AR(1): <span class="math display">\[
\log(A_t) = \rho_A \log(A_{t-1}) + \varepsilon_{A,t}, \quad \varepsilon_{A,t} \sim N(0, \sigma_A^2)
\]</span></p>
</section>
<section id="market-clearing" class="level2">
<h2 class="anchored" data-anchor-id="market-clearing">Market Clearing</h2>
<p><span class="math display">\[
Y_t = C_t + I_t
\]</span></p>
<p>where investment <span class="math inline">\(I_t = K_t - (1-\delta)K_{t-1}\)</span>.</p>
</section>
<section id="the-complete-rbc-model" class="level2">
<h2 class="anchored" data-anchor-id="the-complete-rbc-model">The Complete RBC Model</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 37%">
<col style="width: 22%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>Equation</th>
<th>Name</th>
<th>Variables</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\frac{1}{C_t} = \beta \mathbb{E}_t\left[\frac{1}{C_{t+1}}(R_{t+1}^K + 1 - \delta)\right]\)</span></td>
<td>Euler</td>
<td><span class="math inline">\(C, R^K\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(\chi N_t^\phi C_t = W_t\)</span></td>
<td>Labor supply</td>
<td><span class="math inline">\(N, C, W\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(Y_t = A_t K_{t-1}^\alpha N_t^{1-\alpha}\)</span></td>
<td>Production</td>
<td><span class="math inline">\(Y, A, K, N\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(W_t = (1-\alpha) Y_t / N_t\)</span></td>
<td>Labor demand</td>
<td><span class="math inline">\(W, Y, N\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(R_t^K = \alpha Y_t / K_{t-1}\)</span></td>
<td>Capital demand</td>
<td><span class="math inline">\(R^K, Y, K\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(Y_t = C_t + K_t - (1-\delta)K_{t-1}\)</span></td>
<td>Resource</td>
<td><span class="math inline">\(Y, C, K\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\log A_t = \rho_A \log A_{t-1} + \varepsilon_A\)</span></td>
<td>Technology</td>
<td><span class="math inline">\(A\)</span></td>
</tr>
</tbody>
</table>
<p><strong>7 equations, 7 unknowns</strong>: <span class="math inline">\((Y, C, N, K, W, R^K, A)\)</span></p>
</section>
</section>
<section id="the-new-keynesian-model" class="level1 unnumbered">
<h1 class="unnumbered">The New Keynesian Model</h1>
<p>The RBC model has no role for monetary policy (all real). The <strong>New Keynesian</strong> model adds:</p>
<ol type="1">
<li><strong>Nominal rigidities</strong> (sticky prices/wages)</li>
<li><strong>Monopolistic competition</strong> (firms have pricing power)</li>
<li><strong>Monetary policy</strong> (central bank sets interest rate)</li>
</ol>
<section id="the-3-equation-nk-model" class="level2">
<h2 class="anchored" data-anchor-id="the-3-equation-nk-model">The 3-Equation NK Model</h2>
<p>The canonical log-linearized NK model:</p>
<section id="is-curve-dynamic-is" class="level3">
<h3 class="anchored" data-anchor-id="is-curve-dynamic-is">1. IS Curve (Dynamic IS)</h3>
<p>From the household’s Euler equation: <span class="math display">\[
\hat{y}_t = \mathbb{E}_t[\hat{y}_{t+1}] - \frac{1}{\sigma}(i_t - \mathbb{E}_t[\pi_{t+1}] - r_t^n)
\]</span></p>
<p>where: - <span class="math inline">\(\hat{y}_t\)</span> = output gap (deviation from flexible-price equilibrium) - <span class="math inline">\(i_t\)</span> = nominal interest rate - <span class="math inline">\(\pi_t\)</span> = inflation - <span class="math inline">\(r_t^n\)</span> = natural rate of interest - <span class="math inline">\(\sigma\)</span> = inverse elasticity of intertemporal substitution</p>
<p><strong>Interpretation</strong>: Higher real interest rate → postpone consumption → lower output today.</p>
</section>
<section id="phillips-curve-nkpc" class="level3">
<h3 class="anchored" data-anchor-id="phillips-curve-nkpc">2. Phillips Curve (NKPC)</h3>
<p>From <strong>Calvo pricing</strong> (fraction <span class="math inline">\(1-\theta\)</span> of firms adjust each period): <span class="math display">\[
\pi_t = \beta \mathbb{E}_t[\pi_{t+1}] + \kappa \hat{y}_t
\]</span></p>
<p>where: <span class="math display">\[
\kappa = \frac{(1-\theta)(1-\beta\theta)}{\theta} \cdot (\sigma + \phi)
\]</span></p>
<p><strong>Interpretation</strong>: Inflation today depends on expected future inflation plus current output gap (marginal cost pressure).</p>
</section>
<section id="taylor-rule" class="level3">
<h3 class="anchored" data-anchor-id="taylor-rule">3. Taylor Rule</h3>
<p>Central bank sets interest rate: <span class="math display">\[
i_t = \rho_i i_{t-1} + (1-\rho_i)\left[r^* + \phi_\pi(\pi_t - \pi^*) + \phi_y \hat{y}_t\right] + \varepsilon_{m,t}
\]</span></p>
<p><strong>Standard calibration</strong>:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 32%">
<col style="width: 20%">
<col style="width: 47%">
</colgroup>
<thead>
<tr class="header">
<th>Parameter</th>
<th>Value</th>
<th>Interpretation</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\rho_i\)</span></td>
<td>0.8</td>
<td>Interest rate smoothing</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\phi_\pi\)</span></td>
<td>1.5</td>
<td>Response to inflation (<strong>Taylor principle</strong>: <span class="math inline">\(\phi_\pi &gt; 1\)</span>)</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\phi_y\)</span></td>
<td>0.5/4 = 0.125</td>
<td>Response to output gap (quarterly)</td>
</tr>
</tbody>
</table>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Solve simple 3-eq NK model</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co"># Parameters</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>beta <span class="ot">&lt;-</span> <span class="fl">0.99</span></span>
<span id="cb2-4"><a href="#cb2-4"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>kappa <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb2-6"><a href="#cb2-6"></a>phi_pi <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>phi_y <span class="ot">&lt;-</span> <span class="fl">0.125</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>rho_i <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb2-9"><a href="#cb2-9"></a></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co"># Monetary policy shock simulation</span></span>
<span id="cb2-11"><a href="#cb2-11"></a>T_sim <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>eps_m <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fu">rep</span>(<span class="dv">0</span>, T_sim <span class="sc">-</span> <span class="dv">2</span>))  <span class="co"># 25bp shock at t=2</span></span>
<span id="cb2-13"><a href="#cb2-13"></a></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co"># Initialize</span></span>
<span id="cb2-15"><a href="#cb2-15"></a>y_gap <span class="ot">&lt;-</span> pi <span class="ot">&lt;-</span> i_rate <span class="ot">&lt;-</span> <span class="fu">numeric</span>(T_sim)</span>
<span id="cb2-16"><a href="#cb2-16"></a>y_gap[<span class="dv">1</span>] <span class="ot">&lt;-</span> pi[<span class="dv">1</span>] <span class="ot">&lt;-</span> i_rate[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb2-17"><a href="#cb2-17"></a></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co"># Simple forward-looking solution (assuming expectations = 0 for simplicity)</span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="co"># More rigorous: use Blanchard-Kahn</span></span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>T_sim) {</span>
<span id="cb2-21"><a href="#cb2-21"></a>  <span class="co"># Taylor rule</span></span>
<span id="cb2-22"><a href="#cb2-22"></a>  i_rate[t] <span class="ot">&lt;-</span> rho_i <span class="sc">*</span> i_rate[t<span class="dv">-1</span>] <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> rho_i) <span class="sc">*</span> (phi_pi <span class="sc">*</span> pi[t<span class="dv">-1</span>] <span class="sc">+</span> phi_y <span class="sc">*</span> y_gap[t<span class="dv">-1</span>]) <span class="sc">+</span> eps_m[t]</span>
<span id="cb2-23"><a href="#cb2-23"></a></span>
<span id="cb2-24"><a href="#cb2-24"></a>  <span class="co"># IS curve (simplified: E[y+1] = 0, E[pi+1] = 0)</span></span>
<span id="cb2-25"><a href="#cb2-25"></a>  y_gap[t] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>sigma <span class="sc">*</span> (i_rate[t] <span class="sc">-</span> <span class="dv">0</span> <span class="sc">-</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="fl">0.7</span> <span class="sc">*</span> y_gap[t<span class="dv">-1</span>]</span>
<span id="cb2-26"><a href="#cb2-26"></a></span>
<span id="cb2-27"><a href="#cb2-27"></a>  <span class="co"># Phillips curve</span></span>
<span id="cb2-28"><a href="#cb2-28"></a>  pi[t] <span class="ot">&lt;-</span> beta <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> kappa <span class="sc">*</span> y_gap[t] <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> pi[t<span class="dv">-1</span>]</span>
<span id="cb2-29"><a href="#cb2-29"></a>}</span>
<span id="cb2-30"><a href="#cb2-30"></a></span>
<span id="cb2-31"><a href="#cb2-31"></a>nk_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb2-32"><a href="#cb2-32"></a>  <span class="at">t =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>T_sim, <span class="dv">3</span>),</span>
<span id="cb2-33"><a href="#cb2-33"></a>  <span class="at">value =</span> <span class="fu">c</span>(y_gap <span class="sc">*</span> <span class="dv">100</span>, pi <span class="sc">*</span> <span class="dv">100</span>, i_rate <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb2-34"><a href="#cb2-34"></a>  <span class="at">variable =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Output Gap (%)"</span>, <span class="st">"Inflation (%)"</span>, <span class="st">"Interest Rate (%)"</span>), <span class="at">each =</span> T_sim)</span>
<span id="cb2-35"><a href="#cb2-35"></a>)</span>
<span id="cb2-36"><a href="#cb2-36"></a></span>
<span id="cb2-37"><a href="#cb2-37"></a><span class="fu">ggplot</span>(nk_df, <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> value, <span class="at">color =</span> variable)) <span class="sc">+</span></span>
<span id="cb2-38"><a href="#cb2-38"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2-39"><a href="#cb2-39"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb2-40"><a href="#cb2-40"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb2-41"><a href="#cb2-41"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Response to 25bp Monetary Policy Shock"</span>,</span>
<span id="cb2-42"><a href="#cb2-42"></a>       <span class="at">subtitle =</span> <span class="st">"Simplified 3-equation NK model"</span>,</span>
<span id="cb2-43"><a href="#cb2-43"></a>       <span class="at">x =</span> <span class="st">"Quarters"</span>, <span class="at">y =</span> <span class="st">"Percent deviation"</span>) <span class="sc">+</span></span>
<span id="cb2-44"><a href="#cb2-44"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#3498db"</span>, <span class="st">"#e74c3c"</span>, <span class="st">"#2ecc71"</span>)) <span class="sc">+</span></span>
<span id="cb2-45"><a href="#cb2-45"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb2-46"><a href="#cb2-46"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="10_dsge_foundations_files/figure-html/nk-3eq-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>The 3-equation New Keynesian model</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="deriving-the-phillips-curve" class="level2">
<h2 class="anchored" data-anchor-id="deriving-the-phillips-curve">Deriving the Phillips Curve</h2>
<section id="calvo-pricing-setup" class="level3">
<h3 class="anchored" data-anchor-id="calvo-pricing-setup">Calvo Pricing Setup</h3>
<ul>
<li>Each period, fraction <span class="math inline">\(1-\theta\)</span> of firms can reset prices</li>
<li>Fraction <span class="math inline">\(\theta\)</span> are “stuck” with last period’s price</li>
<li>When firms can adjust, they set price to maximize expected profits over the time they’ll be stuck</li>
</ul>
</section>
<section id="optimal-price-setting" class="level3">
<h3 class="anchored" data-anchor-id="optimal-price-setting">Optimal Price Setting</h3>
<p>A firm that can adjust at time <span class="math inline">\(t\)</span> chooses <span class="math inline">\(P_t^*\)</span> to maximize: <span class="math display">\[
\mathbb{E}_t \sum_{k=0}^{\infty} (\beta\theta)^k \left[ \frac{P_t^*}{P_{t+k}} Y_{t+k|t} - MC_{t+k} Y_{t+k|t} \right]
\]</span></p>
<p><strong>Result</strong> (after log-linearization): <span class="math display">\[
\hat{p}_t^* = (1-\beta\theta) \sum_{k=0}^{\infty} (\beta\theta)^k \mathbb{E}_t[\widehat{mc}_{t+k}]
\]</span></p>
<p>Firms set prices as a weighted average of expected future marginal costs.</p>
</section>
<section id="aggregating-to-the-phillips-curve" class="level3">
<h3 class="anchored" data-anchor-id="aggregating-to-the-phillips-curve">Aggregating to the Phillips Curve</h3>
<p>Price index evolution: <span class="math display">\[
P_t = \left[\theta P_{t-1}^{1-\epsilon} + (1-\theta)(P_t^*)^{1-\epsilon}\right]^{\frac{1}{1-\epsilon}}
\]</span></p>
<p>Log-linearizing and combining: <span class="math display">\[
\pi_t = \beta \mathbb{E}_t[\pi_{t+1}] + \kappa \cdot \widehat{mc}_t
\]</span></p>
<p>With <span class="math inline">\(\widehat{mc}_t \propto \hat{y}_t\)</span> (output gap approximates marginal cost deviations).</p>
</section>
</section>
</section>
<section id="log-linearization" class="level1 unnumbered">
<h1 class="unnumbered">Log-Linearization</h1>
<p>DSGE models are nonlinear. To solve them analytically (or with first-order perturbation), we <strong>log-linearize</strong> around the steady state.</p>
<section id="the-technique" class="level2">
<h2 class="anchored" data-anchor-id="the-technique">The Technique</h2>
<p>For any variable <span class="math inline">\(X_t\)</span>:</p>
<p><span class="math display">\[
\hat{x}_t \equiv \log(X_t) - \log(\bar{X}) = \log\left(\frac{X_t}{\bar{X}}\right) \approx \frac{X_t - \bar{X}}{\bar{X}}
\]</span></p>
<p>So <span class="math inline">\(\hat{x}_t\)</span> is the <strong>percentage deviation from steady state</strong>.</p>
<section id="key-approximation" class="level3">
<h3 class="anchored" data-anchor-id="key-approximation">Key Approximation</h3>
<p>For any function <span class="math inline">\(f(X_t, Y_t)\)</span>: <span class="math display">\[
f(X_t, Y_t) \approx f(\bar{X}, \bar{Y}) + f_X(\bar{X}, \bar{Y})(X_t - \bar{X}) + f_Y(\bar{X}, \bar{Y})(Y_t - \bar{Y})
\]</span></p>
</section>
<section id="example-euler-equation" class="level3">
<h3 class="anchored" data-anchor-id="example-euler-equation">Example: Euler Equation</h3>
<p>Nonlinear Euler: <span class="math display">\[
\frac{1}{C_t} = \beta \mathbb{E}_t\left[\frac{1}{C_{t+1}} R_{t+1}\right]
\]</span></p>
<p><strong>Step 1</strong>: Steady state <span class="math display">\[
\frac{1}{\bar{C}} = \beta \frac{1}{\bar{C}} \bar{R} \implies \bar{R} = \frac{1}{\beta}
\]</span></p>
<p><strong>Step 2</strong>: Log-linearize. Let <span class="math inline">\(C_t = \bar{C} e^{\hat{c}_t} \approx \bar{C}(1 + \hat{c}_t)\)</span>: <span class="math display">\[
\frac{1}{\bar{C}(1 + \hat{c}_t)} = \beta \mathbb{E}_t\left[\frac{1}{\bar{C}(1 + \hat{c}_{t+1})} \bar{R}(1 + \hat{r}_{t+1})\right]
\]</span></p>
<p><strong>Step 3</strong>: First-order Taylor expansion (ignore second-order terms): <span class="math display">\[
1 - \hat{c}_t = \beta \bar{R} \mathbb{E}_t\left[(1 - \hat{c}_{t+1})(1 + \hat{r}_{t+1})\right]
\]</span> <span class="math display">\[
1 - \hat{c}_t \approx \mathbb{E}_t[1 - \hat{c}_{t+1} + \hat{r}_{t+1}]
\]</span></p>
<p><strong>Result</strong>: <span class="math display">\[
\hat{c}_t = \mathbb{E}_t[\hat{c}_{t+1}] - (\hat{r}_{t+1} - 0)
\]</span></p>
<p>This is the <strong>log-linearized Euler equation</strong> (with <span class="math inline">\(\sigma = 1\)</span>).</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Compare nonlinear vs log-linear Euler</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>C_ss <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb3-3"><a href="#cb3-3"></a>beta <span class="ot">&lt;-</span> <span class="fl">0.99</span></span>
<span id="cb3-4"><a href="#cb3-4"></a>R_ss <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>beta</span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co"># Deviations from steady state</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>c_dev <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.01</span>)</span>
<span id="cb3-8"><a href="#cb3-8"></a></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co"># Nonlinear: U'(C) = 1/C</span></span>
<span id="cb3-10"><a href="#cb3-10"></a>uprime_nonlinear <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (C_ss <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> c_dev))</span>
<span id="cb3-11"><a href="#cb3-11"></a></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co"># Log-linear: U'(C) ≈ 1/C_ss * (1 - c_dev)</span></span>
<span id="cb3-13"><a href="#cb3-13"></a>uprime_linear <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">/</span>C_ss) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> c_dev)</span>
<span id="cb3-14"><a href="#cb3-14"></a></span>
<span id="cb3-15"><a href="#cb3-15"></a>approx_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb3-16"><a href="#cb3-16"></a>  <span class="at">deviation =</span> <span class="fu">rep</span>(c_dev <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb3-17"><a href="#cb3-17"></a>  <span class="at">marginal_utility =</span> <span class="fu">c</span>(uprime_nonlinear, uprime_linear),</span>
<span id="cb3-18"><a href="#cb3-18"></a>  <span class="at">method =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Nonlinear"</span>, <span class="st">"Log-linear"</span>), <span class="at">each =</span> <span class="fu">length</span>(c_dev))</span>
<span id="cb3-19"><a href="#cb3-19"></a>)</span>
<span id="cb3-20"><a href="#cb3-20"></a></span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="fu">ggplot</span>(approx_df, <span class="fu">aes</span>(<span class="at">x =</span> deviation, <span class="at">y =</span> marginal_utility, <span class="at">color =</span> method)) <span class="sc">+</span></span>
<span id="cb3-22"><a href="#cb3-22"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb3-23"><a href="#cb3-23"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb3-24"><a href="#cb3-24"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Log-Linearization Accuracy"</span>,</span>
<span id="cb3-25"><a href="#cb3-25"></a>       <span class="at">subtitle =</span> <span class="st">"Approximation works well for small deviations (±10%)"</span>,</span>
<span id="cb3-26"><a href="#cb3-26"></a>       <span class="at">x =</span> <span class="st">"% Deviation from Steady State"</span>,</span>
<span id="cb3-27"><a href="#cb3-27"></a>       <span class="at">y =</span> <span class="st">"Marginal Utility U'(C)"</span>, <span class="at">color =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb3-28"><a href="#cb3-28"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#3498db"</span>, <span class="st">"#e74c3c"</span>)) <span class="sc">+</span></span>
<span id="cb3-29"><a href="#cb3-29"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb3-30"><a href="#cb3-30"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="10_dsge_foundations_files/figure-html/log-lin-demo-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Log-linearization accuracy</figcaption>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="solving-rational-expectations-models" class="level1 unnumbered">
<h1 class="unnumbered">Solving Rational Expectations Models</h1>
<p>After log-linearization, DSGE models take the form:</p>
<p><span class="math display">\[
A \mathbb{E}_t[y_{t+1}] = B y_t + C u_t
\]</span></p>
<p>where <span class="math inline">\(y_t\)</span> contains both <strong>predetermined</strong> (state) and <strong>jump</strong> (control) variables.</p>
<section id="partitioning-the-system" class="level2">
<h2 class="anchored" data-anchor-id="partitioning-the-system">Partitioning the System</h2>
<p>Split <span class="math inline">\(y_t = \begin{pmatrix} x_t \\ z_t \end{pmatrix}\)</span> where:</p>
<ul>
<li><span class="math inline">\(x_t\)</span>: <strong>Predetermined</strong> (state) variables — known at time <span class="math inline">\(t\)</span> (e.g., capital <span class="math inline">\(K_{t-1}\)</span>)</li>
<li><span class="math inline">\(z_t\)</span>: <strong>Jump</strong> (forward-looking) variables — can adjust freely (e.g., consumption, inflation)</li>
</ul>
</section>
<section id="blanchard-kahn-conditions" class="level2">
<h2 class="anchored" data-anchor-id="blanchard-kahn-conditions">Blanchard-Kahn Conditions</h2>
<p>The <strong>eigenvalue decomposition</strong> of the system matrix determines solvability <span class="citation" data-cites="blanchard1980">(<a href="../references.html#ref-blanchard1980" role="doc-biblioref">Blanchard and Kahn 1980</a>)</span>.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Important</span>Blanchard-Kahn (1980) Conditions
</div>
</div>
<div class="callout-body-container callout-body">
<p>For a unique stable solution:</p>
<blockquote class="blockquote">
<p><strong>Number of eigenvalues outside unit circle = Number of jump variables</strong></p>
</blockquote>
</div>
</div>
<table class="caption-top table">
<colgroup>
<col style="width: 62%">
<col style="width: 37%">
</colgroup>
<thead>
<tr class="header">
<th>Eigenvalue Count</th>
<th>Diagnosis</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Equals number of jump vars</td>
<td><strong>Unique solution</strong> (saddle-path stable)</td>
</tr>
<tr class="even">
<td>Less than number of jump vars</td>
<td><strong>Indeterminacy</strong> (multiple equilibria, sunspots)</td>
</tr>
<tr class="odd">
<td>Greater than number of jump vars</td>
<td><strong>No solution</strong> (explosive dynamics)</td>
</tr>
</tbody>
</table>
</section>
<section id="the-solution-form" class="level2">
<h2 class="anchored" data-anchor-id="the-solution-form">The Solution Form</h2>
<p>If BK conditions hold, the solution is:</p>
<p><span class="math display">\[
x_{t+1} = H_x x_t + H_u u_{t+1}
\]</span> <span class="math display">\[
z_t = G_x x_t
\]</span></p>
<p>The <strong>policy function</strong> <span class="math inline">\(G_x\)</span> tells us how jump variables respond to states. The <strong>transition matrix</strong> <span class="math inline">\(H_x\)</span> governs state evolution.</p>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Illustrate saddle-path in a simple 2-variable system</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co"># x_t = state (capital), z_t = control (consumption)</span></span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co"># Phase diagram for consumption-capital</span></span>
<span id="cb4-5"><a href="#cb4-5"></a>k_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">0.02</span>)</span>
<span id="cb4-6"><a href="#cb4-6"></a>c_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">0.02</span>)</span>
<span id="cb4-7"><a href="#cb4-7"></a></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co"># Steady state (normalized)</span></span>
<span id="cb4-9"><a href="#cb4-9"></a>k_ss <span class="ot">&lt;-</span> c_ss <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb4-10"><a href="#cb4-10"></a></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co"># Simplified dynamics for illustration</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co"># dk/dt = 0 locus: c = f(k) - delta*k</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co"># dc/dt = 0 locus: f'(k) = rho + delta</span></span>
<span id="cb4-14"><a href="#cb4-14"></a></span>
<span id="cb4-15"><a href="#cb4-15"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.33</span></span>
<span id="cb4-16"><a href="#cb4-16"></a>delta <span class="ot">&lt;-</span> <span class="fl">0.025</span></span>
<span id="cb4-17"><a href="#cb4-17"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb4-18"><a href="#cb4-18"></a></span>
<span id="cb4-19"><a href="#cb4-19"></a><span class="co"># Nullclines</span></span>
<span id="cb4-20"><a href="#cb4-20"></a>c_from_k_nullcline <span class="ot">&lt;-</span> <span class="cf">function</span>(k) k<span class="sc">^</span>alpha <span class="sc">-</span> delta <span class="sc">*</span> k</span>
<span id="cb4-21"><a href="#cb4-21"></a>k_from_c_nullcline <span class="ot">&lt;-</span> (alpha <span class="sc">/</span> (rho <span class="sc">+</span> delta))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>alpha))</span>
<span id="cb4-22"><a href="#cb4-22"></a></span>
<span id="cb4-23"><a href="#cb4-23"></a><span class="co"># Create phase diagram</span></span>
<span id="cb4-24"><a href="#cb4-24"></a>phase_df <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">k =</span> k_grid, <span class="at">c =</span> c_grid) <span class="sc">%&gt;%</span></span>
<span id="cb4-25"><a href="#cb4-25"></a>  <span class="fu">mutate</span>(</span>
<span id="cb4-26"><a href="#cb4-26"></a>    <span class="at">dk =</span> k<span class="sc">^</span>alpha <span class="sc">-</span> c <span class="sc">-</span> delta <span class="sc">*</span> k,</span>
<span id="cb4-27"><a href="#cb4-27"></a>    <span class="at">dc =</span> (alpha <span class="sc">*</span> k<span class="sc">^</span>(alpha<span class="dv">-1</span>) <span class="sc">-</span> delta <span class="sc">-</span> rho) <span class="sc">*</span> c <span class="sc">/</span> <span class="dv">2</span>  <span class="co"># simplified</span></span>
<span id="cb4-28"><a href="#cb4-28"></a>  )</span>
<span id="cb4-29"><a href="#cb4-29"></a></span>
<span id="cb4-30"><a href="#cb4-30"></a><span class="co"># Saddle path (approximate)</span></span>
<span id="cb4-31"><a href="#cb4-31"></a>saddle_path <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb4-32"><a href="#cb4-32"></a>  <span class="at">k =</span> <span class="fu">seq</span>(<span class="fl">0.7</span>, <span class="fl">1.3</span>, <span class="fl">0.01</span>),</span>
<span id="cb4-33"><a href="#cb4-33"></a>  <span class="at">c =</span> c_ss <span class="sc">+</span> <span class="fl">0.8</span> <span class="sc">*</span> (k <span class="sc">-</span> k_ss)  <span class="co"># slope of stable eigenvector</span></span>
<span id="cb4-34"><a href="#cb4-34"></a>)</span>
<span id="cb4-35"><a href="#cb4-35"></a></span>
<span id="cb4-36"><a href="#cb4-36"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb4-37"><a href="#cb4-37"></a>  <span class="co"># Direction field</span></span>
<span id="cb4-38"><a href="#cb4-38"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> phase_df <span class="sc">%&gt;%</span> <span class="fu">sample_n</span>(<span class="dv">200</span>),</span>
<span id="cb4-39"><a href="#cb4-39"></a>               <span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> c, <span class="at">xend =</span> k <span class="sc">+</span> dk<span class="sc">*</span><span class="fl">0.05</span>, <span class="at">yend =</span> c <span class="sc">+</span> dc<span class="sc">*</span><span class="fl">0.05</span>),</span>
<span id="cb4-40"><a href="#cb4-40"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"cm"</span>)), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb4-41"><a href="#cb4-41"></a>  <span class="co"># Nullclines</span></span>
<span id="cb4-42"><a href="#cb4-42"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> c_from_k_nullcline, <span class="at">color =</span> <span class="st">"#3498db"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb4-43"><a href="#cb4-43"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> k_from_c_nullcline, <span class="at">color =</span> <span class="st">"#e74c3c"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb4-44"><a href="#cb4-44"></a>  <span class="co"># Saddle path</span></span>
<span id="cb4-45"><a href="#cb4-45"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> saddle_path, <span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> c),</span>
<span id="cb4-46"><a href="#cb4-46"></a>            <span class="at">color =</span> <span class="st">"#2ecc71"</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb4-47"><a href="#cb4-47"></a>  <span class="co"># Steady state</span></span>
<span id="cb4-48"><a href="#cb4-48"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> k_ss, <span class="at">y =</span> c_ss), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb4-49"><a href="#cb4-49"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> k_ss <span class="sc">+</span> <span class="fl">0.05</span>, <span class="at">y =</span> c_ss <span class="sc">+</span> <span class="fl">0.05</span>, <span class="at">label =</span> <span class="st">"Steady State"</span>) <span class="sc">+</span></span>
<span id="cb4-50"><a href="#cb4-50"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.3</span>, <span class="at">y =</span> <span class="fu">c_from_k_nullcline</span>(<span class="fl">1.3</span>) <span class="sc">-</span> <span class="fl">0.05</span>,</span>
<span id="cb4-51"><a href="#cb4-51"></a>           <span class="at">label =</span> <span class="st">"dk = 0"</span>, <span class="at">color =</span> <span class="st">"#3498db"</span>) <span class="sc">+</span></span>
<span id="cb4-52"><a href="#cb4-52"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> k_from_c_nullcline <span class="sc">+</span> <span class="fl">0.05</span>, <span class="at">y =</span> <span class="fl">1.4</span>,</span>
<span id="cb4-53"><a href="#cb4-53"></a>           <span class="at">label =</span> <span class="st">"dc = 0"</span>, <span class="at">color =</span> <span class="st">"#e74c3c"</span>) <span class="sc">+</span></span>
<span id="cb4-54"><a href="#cb4-54"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> c_ss <span class="sc">+</span> <span class="fl">0.8</span> <span class="sc">*</span> <span class="fl">0.2</span> <span class="sc">+</span> <span class="fl">0.05</span>,</span>
<span id="cb4-55"><a href="#cb4-55"></a>           <span class="at">label =</span> <span class="st">"Saddle Path"</span>, <span class="at">color =</span> <span class="st">"#2ecc71"</span>) <span class="sc">+</span></span>
<span id="cb4-56"><a href="#cb4-56"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Saddle-Path Stability in DSGE"</span>,</span>
<span id="cb4-57"><a href="#cb4-57"></a>       <span class="at">subtitle =</span> <span class="st">"Jump variable (c) must be on saddle path for convergence"</span>,</span>
<span id="cb4-58"><a href="#cb4-58"></a>       <span class="at">x =</span> <span class="st">"Capital (k)"</span>, <span class="at">y =</span> <span class="st">"Consumption (c)"</span>) <span class="sc">+</span></span>
<span id="cb4-59"><a href="#cb4-59"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">1.4</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">1.4</span>)) <span class="sc">+</span></span>
<span id="cb4-60"><a href="#cb4-60"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="10_dsge_foundations_files/figure-html/bk-illustration-1.png" class="img-fluid figure-img" width="960"></p>
<figcaption>Blanchard-Kahn: saddle-path stability</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="common-causes-of-bk-violations" class="level2">
<h2 class="anchored" data-anchor-id="common-causes-of-bk-violations">Common Causes of BK Violations</h2>
<table class="caption-top table">
<colgroup>
<col style="width: 30%">
<col style="width: 30%">
<col style="width: 40%">
</colgroup>
<thead>
<tr class="header">
<th>Problem</th>
<th>Symptom</th>
<th>Common Fix</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Taylor principle violated</strong></td>
<td>Too few unstable roots</td>
<td>Raise <span class="math inline">\(\phi_\pi\)</span> above 1</td>
</tr>
<tr class="even">
<td><strong>Missing expectations</strong></td>
<td>Wrong root count</td>
<td>Check all <span class="math inline">\(\mathbb{E}_t\)</span> terms</td>
</tr>
<tr class="odd">
<td><strong>Timing error</strong></td>
<td>Explosive solutions</td>
<td>Dynare uses end-of-period capital: use <span class="math inline">\(K(-1)\)</span></td>
</tr>
<tr class="even">
<td><strong>Wrong variable classification</strong></td>
<td>Indeterminacy</td>
<td>Re-check predetermined vs.&nbsp;jump</td>
</tr>
</tbody>
</table>
</section>
<section id="numerical-solution-qz-decomposition" class="level2">
<h2 class="anchored" data-anchor-id="numerical-solution-qz-decomposition">Numerical Solution: QZ Decomposition</h2>
<p>For larger models, we use the <strong>generalized Schur (QZ) decomposition</strong>:</p>
<p><span class="math display">\[
A = Q \Lambda Z', \quad B = Q \Omega Z'
\]</span></p>
<p>where <span class="math inline">\(\Lambda/\Omega\)</span> gives generalized eigenvalues. Reorder to put unstable eigenvalues in the bottom block.</p>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># R code sketch for BK solution</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>solve_dsge_bk <span class="ot">&lt;-</span> <span class="cf">function</span>(A, B, n_state) {</span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="co"># A * E[y_{t+1}] = B * y_t</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="co"># y = [x; z] where x = states, z = jumps</span></span>
<span id="cb5-5"><a href="#cb5-5"></a></span>
<span id="cb5-6"><a href="#cb5-6"></a>  n_total <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb5-7"><a href="#cb5-7"></a>  n_jump <span class="ot">&lt;-</span> n_total <span class="sc">-</span> n_state</span>
<span id="cb5-8"><a href="#cb5-8"></a></span>
<span id="cb5-9"><a href="#cb5-9"></a>  <span class="co"># QZ decomposition</span></span>
<span id="cb5-10"><a href="#cb5-10"></a>  qz <span class="ot">&lt;-</span> geigen<span class="sc">::</span><span class="fu">gqz</span>(A, B)  <span class="co"># Generalized Schur</span></span>
<span id="cb5-11"><a href="#cb5-11"></a></span>
<span id="cb5-12"><a href="#cb5-12"></a>  <span class="co"># Eigenvalues</span></span>
<span id="cb5-13"><a href="#cb5-13"></a>  eig <span class="ot">&lt;-</span> qz<span class="sc">$</span>alpha <span class="sc">/</span> qz<span class="sc">$</span>beta</span>
<span id="cb5-14"><a href="#cb5-14"></a>  n_unstable <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">abs</span>(eig) <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb5-15"><a href="#cb5-15"></a></span>
<span id="cb5-16"><a href="#cb5-16"></a>  <span class="co"># Check BK conditions</span></span>
<span id="cb5-17"><a href="#cb5-17"></a>  <span class="cf">if</span> (n_unstable <span class="sc">!=</span> n_jump) {</span>
<span id="cb5-18"><a href="#cb5-18"></a>    <span class="fu">stop</span>(<span class="fu">paste</span>(<span class="st">"BK violation:"</span>, n_unstable, <span class="st">"unstable,"</span>, n_jump, <span class="st">"jump vars"</span>))</span>
<span id="cb5-19"><a href="#cb5-19"></a>  }</span>
<span id="cb5-20"><a href="#cb5-20"></a></span>
<span id="cb5-21"><a href="#cb5-21"></a>  <span class="co"># Extract policy function (from stable block)</span></span>
<span id="cb5-22"><a href="#cb5-22"></a>  <span class="co"># ... (reorder and partition)</span></span>
<span id="cb5-23"><a href="#cb5-23"></a></span>
<span id="cb5-24"><a href="#cb5-24"></a>  <span class="fu">list</span>(<span class="at">G =</span> G_matrix, <span class="at">H =</span> H_matrix, <span class="at">eigenvalues =</span> eig)</span>
<span id="cb5-25"><a href="#cb5-25"></a>}</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
</section>
<section id="calibration" class="level1 unnumbered">
<h1 class="unnumbered">Calibration</h1>
<p>Before estimation (Module 11), we <strong>calibrate</strong> parameters using:</p>
<ol type="1">
<li><strong>Microeconomic evidence</strong> (labor supply elasticity, depreciation rate)</li>
<li><strong>Long-run averages</strong> (capital-output ratio, hours worked)</li>
<li><strong>Steady-state relationships</strong> (Euler equation pins down <span class="math inline">\(\beta\)</span>)</li>
</ol>
<section id="standard-rbcnk-calibration" class="level2">
<h2 class="anchored" data-anchor-id="standard-rbcnk-calibration">Standard RBC/NK Calibration</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Parameter</th>
<th>Symbol</th>
<th>Value</th>
<th>Source</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Discount factor</td>
<td><span class="math inline">\(\beta\)</span></td>
<td>0.99</td>
<td>Real interest rate ≈ 4% annually</td>
</tr>
<tr class="even">
<td>Capital share</td>
<td><span class="math inline">\(\alpha\)</span></td>
<td>0.33</td>
<td>National accounts</td>
</tr>
<tr class="odd">
<td>Depreciation</td>
<td><span class="math inline">\(\delta\)</span></td>
<td>0.025</td>
<td>10% annual depreciation</td>
</tr>
<tr class="even">
<td>Risk aversion</td>
<td><span class="math inline">\(\sigma\)</span></td>
<td>1-2</td>
<td>Micro studies</td>
</tr>
<tr class="odd">
<td>Frisch elasticity</td>
<td><span class="math inline">\(1/\phi\)</span></td>
<td>0.5-2</td>
<td>Labor supply literature</td>
</tr>
<tr class="even">
<td>Calvo parameter</td>
<td><span class="math inline">\(\theta\)</span></td>
<td>0.75</td>
<td>Prices adjust every 4 quarters</td>
</tr>
<tr class="odd">
<td>Inflation weight</td>
<td><span class="math inline">\(\phi_\pi\)</span></td>
<td>1.5</td>
<td>Taylor (1993)</td>
</tr>
<tr class="even">
<td>Output weight</td>
<td><span class="math inline">\(\phi_y\)</span></td>
<td>0.125</td>
<td>Taylor (1993), quarterly</td>
</tr>
</tbody>
</table>
</section>
<section id="matching-moments" class="level2">
<h2 class="anchored" data-anchor-id="matching-moments">Matching Moments</h2>
<p><strong>Target</strong>: Model-implied moments ≈ Data moments</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Moment</th>
<th>Data (US)</th>
<th>Typical RBC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>std(Y)</td>
<td>1.5-2%</td>
<td>Match by calibrating <span class="math inline">\(\sigma_A\)</span></td>
</tr>
<tr class="even">
<td>std(C)/std(Y)</td>
<td>0.5-0.7</td>
<td>Endogenous</td>
</tr>
<tr class="odd">
<td>std(I)/std(Y)</td>
<td>2.5-3.5</td>
<td>Endogenous</td>
</tr>
<tr class="even">
<td>corr(C, Y)</td>
<td>0.8-0.9</td>
<td>Endogenous</td>
</tr>
<tr class="odd">
<td>corr(N, Y)</td>
<td>0.8-0.9</td>
<td>Endogenous</td>
</tr>
</tbody>
</table>
<div class="cell" data-layout-align="center">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co"># Simulate RBC model and compute moments</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co"># Simplified AR(1) approximation</span></span>
<span id="cb6-3"><a href="#cb6-3"></a></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co"># Parameters</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>rho_a <span class="ot">&lt;-</span> <span class="fl">0.95</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>sigma_a <span class="ot">&lt;-</span> <span class="fl">0.007</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>T_sim <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb6-8"><a href="#cb6-8"></a></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co"># Technology shock</span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb6-11"><a href="#cb6-11"></a>log_a <span class="ot">&lt;-</span> <span class="fu">numeric</span>(T_sim)</span>
<span id="cb6-12"><a href="#cb6-12"></a>log_a[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>T_sim) {</span>
<span id="cb6-14"><a href="#cb6-14"></a>  log_a[t] <span class="ot">&lt;-</span> rho_a <span class="sc">*</span> log_a[t<span class="dv">-1</span>] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, sigma_a)</span>
<span id="cb6-15"><a href="#cb6-15"></a>}</span>
<span id="cb6-16"><a href="#cb6-16"></a></span>
<span id="cb6-17"><a href="#cb6-17"></a><span class="co"># Simplified responses (from RBC solution)</span></span>
<span id="cb6-18"><a href="#cb6-18"></a><span class="co"># Output: y_hat ≈ (1 + alpha/(1-alpha)) * a_hat</span></span>
<span id="cb6-19"><a href="#cb6-19"></a><span class="co"># Consumption: c_hat ≈ 0.7 * y_hat (consumption smoother than output)</span></span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="co"># Investment: i_hat ≈ 3 * y_hat (investment more volatile)</span></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="co"># Hours: n_hat ≈ 0.5 * y_hat</span></span>
<span id="cb6-22"><a href="#cb6-22"></a></span>
<span id="cb6-23"><a href="#cb6-23"></a>y_hat <span class="ot">&lt;-</span> <span class="fl">1.5</span> <span class="sc">*</span> log_a</span>
<span id="cb6-24"><a href="#cb6-24"></a>c_hat <span class="ot">&lt;-</span> <span class="fl">0.7</span> <span class="sc">*</span> y_hat <span class="sc">+</span> <span class="fu">rnorm</span>(T_sim, <span class="dv">0</span>, <span class="fl">0.002</span>)</span>
<span id="cb6-25"><a href="#cb6-25"></a>i_hat <span class="ot">&lt;-</span> <span class="fl">3.0</span> <span class="sc">*</span> y_hat <span class="sc">+</span> <span class="fu">rnorm</span>(T_sim, <span class="dv">0</span>, <span class="fl">0.005</span>)</span>
<span id="cb6-26"><a href="#cb6-26"></a>n_hat <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> y_hat <span class="sc">+</span> <span class="fu">rnorm</span>(T_sim, <span class="dv">0</span>, <span class="fl">0.003</span>)</span>
<span id="cb6-27"><a href="#cb6-27"></a></span>
<span id="cb6-28"><a href="#cb6-28"></a><span class="co"># Compute moments</span></span>
<span id="cb6-29"><a href="#cb6-29"></a>moments_model <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb6-30"><a href="#cb6-30"></a>  <span class="at">Variable =</span> <span class="fu">c</span>(<span class="st">"Output"</span>, <span class="st">"Consumption"</span>, <span class="st">"Investment"</span>, <span class="st">"Hours"</span>),</span>
<span id="cb6-31"><a href="#cb6-31"></a>  <span class="st">`</span><span class="at">Std Dev (%)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">sd</span>(y_hat), <span class="fu">sd</span>(c_hat), <span class="fu">sd</span>(i_hat), <span class="fu">sd</span>(n_hat)) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb6-32"><a href="#cb6-32"></a>  <span class="st">`</span><span class="at">Rel to Y</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">sd</span>(c_hat)<span class="sc">/</span><span class="fu">sd</span>(y_hat), <span class="fu">sd</span>(i_hat)<span class="sc">/</span><span class="fu">sd</span>(y_hat), <span class="fu">sd</span>(n_hat)<span class="sc">/</span><span class="fu">sd</span>(y_hat)),</span>
<span id="cb6-33"><a href="#cb6-33"></a>  <span class="st">`</span><span class="at">Corr with Y</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">cor</span>(c_hat, y_hat), <span class="fu">cor</span>(i_hat, y_hat), <span class="fu">cor</span>(n_hat, y_hat))</span>
<span id="cb6-34"><a href="#cb6-34"></a>)</span>
<span id="cb6-35"><a href="#cb6-35"></a></span>
<span id="cb6-36"><a href="#cb6-36"></a><span class="co"># Add data targets</span></span>
<span id="cb6-37"><a href="#cb6-37"></a>moments_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb6-38"><a href="#cb6-38"></a>  <span class="at">Variable =</span> <span class="fu">c</span>(<span class="st">"Output"</span>, <span class="st">"Consumption"</span>, <span class="st">"Investment"</span>, <span class="st">"Hours"</span>),</span>
<span id="cb6-39"><a href="#cb6-39"></a>  <span class="st">`</span><span class="at">Std Dev (%)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.8</span>, <span class="fl">1.0</span>, <span class="fl">5.0</span>, <span class="fl">1.5</span>),</span>
<span id="cb6-40"><a href="#cb6-40"></a>  <span class="st">`</span><span class="at">Rel to Y</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.55</span>, <span class="fl">2.8</span>, <span class="fl">0.83</span>),</span>
<span id="cb6-41"><a href="#cb6-41"></a>  <span class="st">`</span><span class="at">Corr with Y</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.85</span>, <span class="fl">0.90</span>, <span class="fl">0.85</span>)</span>
<span id="cb6-42"><a href="#cb6-42"></a>)</span>
<span id="cb6-43"><a href="#cb6-43"></a></span>
<span id="cb6-44"><a href="#cb6-44"></a><span class="co"># Display</span></span>
<span id="cb6-45"><a href="#cb6-45"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb6-46"><a href="#cb6-46"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb6-47"><a href="#cb6-47"></a>    moments_model <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Source =</span> <span class="st">"Model"</span>),</span>
<span id="cb6-48"><a href="#cb6-48"></a>    moments_data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Source =</span> <span class="st">"Data"</span>)</span>
<span id="cb6-49"><a href="#cb6-49"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb6-50"><a href="#cb6-50"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Source, <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">Std Dev (%)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Rel to Y</span><span class="st">`</span>, <span class="st">`</span><span class="at">Corr with Y</span><span class="st">`</span>)),</span>
<span id="cb6-51"><a href="#cb6-51"></a>  <span class="at">caption =</span> <span class="st">"Business Cycle Moments: Model vs. Data"</span>,</span>
<span id="cb6-52"><a href="#cb6-52"></a>  <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb6-53"><a href="#cb6-53"></a>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</details>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Business Cycle Moments: Model vs.&nbsp;Data</caption>
<colgroup>
<col style="width: 10%">
<col style="width: 16%">
<col style="width: 15%">
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 16%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Variable</th>
<th style="text-align: right;">Std Dev (%)_Model</th>
<th style="text-align: right;">Std Dev (%)_Data</th>
<th style="text-align: right;">Rel to Y_Model</th>
<th style="text-align: right;">Rel to Y_Data</th>
<th style="text-align: right;">Corr with Y_Model</th>
<th style="text-align: right;">Corr with Y_Data</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Output</td>
<td style="text-align: right;">2.26</td>
<td style="text-align: right;">1.8</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">1.00</td>
</tr>
<tr class="even">
<td style="text-align: left;">Consumption</td>
<td style="text-align: right;">1.60</td>
<td style="text-align: right;">1.0</td>
<td style="text-align: right;">0.71</td>
<td style="text-align: right;">0.55</td>
<td style="text-align: right;">0.99</td>
<td style="text-align: right;">0.85</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Investment</td>
<td style="text-align: right;">6.77</td>
<td style="text-align: right;">5.0</td>
<td style="text-align: right;">2.99</td>
<td style="text-align: right;">2.80</td>
<td style="text-align: right;">1.00</td>
<td style="text-align: right;">0.90</td>
</tr>
<tr class="even">
<td style="text-align: left;">Hours</td>
<td style="text-align: right;">1.14</td>
<td style="text-align: right;">1.5</td>
<td style="text-align: right;">0.50</td>
<td style="text-align: right;">0.83</td>
<td style="text-align: right;">0.96</td>
<td style="text-align: right;">0.85</td>
</tr>
</tbody>
</table>
<p>Calibration: matching business cycle moments</p>
</div>
</div>
</section>
<section id="steady-state-relationships" class="level2">
<h2 class="anchored" data-anchor-id="steady-state-relationships">Steady-State Relationships</h2>
<p>Many parameters are pinned down by steady-state conditions:</p>
<p><strong>From Euler equation</strong>: <span class="math display">\[
\bar{R} = \frac{1}{\beta} \implies \beta = \frac{1}{1 + r^*}
\]</span> With <span class="math inline">\(r^* = 4\%\)</span> annually → <span class="math inline">\(\beta = 1/1.01 \approx 0.99\)</span> quarterly.</p>
<p><strong>From capital demand</strong>: <span class="math display">\[
\bar{R}^K = \alpha \frac{\bar{Y}}{\bar{K}} = \frac{1}{\beta} - (1-\delta)
\]</span> Given <span class="math inline">\(\beta\)</span>, <span class="math inline">\(\delta\)</span>, and capital-output ratio, backs out <span class="math inline">\(\alpha\)</span>.</p>
<p><strong>From labor supply</strong>: <span class="math display">\[
\chi \bar{N}^\phi \bar{C} = \bar{W} = (1-\alpha)\frac{\bar{Y}}{\bar{N}}
\]</span> Given target <span class="math inline">\(\bar{N} = 1/3\)</span> (8 hours/day), backs out <span class="math inline">\(\chi\)</span>.</p>
</section>
</section>
<section id="dynare-basics" class="level1 unnumbered">
<h1 class="unnumbered">Dynare Basics</h1>
<p><strong>Dynare</strong> is the standard software for solving and estimating DSGE models. Here’s a minimal example.</p>
<section id="a-simple-rbc-model-in-dynare" class="level2">
<h2 class="anchored" data-anchor-id="a-simple-rbc-model-in-dynare">A Simple RBC Model in Dynare</h2>
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb7"><pre class="sourceCode numberSource matlab number-lines code-with-copy"><code class="sourceCode matlab"><span id="cb7-1"><a href="#cb7-1"></a><span class="co">%% RBC Model - rbc_simple.mod</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co">%% Preamble</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="va">var</span> <span class="va">y</span> <span class="va">c</span> <span class="va">k</span> <span class="va">n</span> <span class="va">w</span> <span class="va">r</span> <span class="va">a</span><span class="op">;</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="va">varexo</span> <span class="va">eps_a</span><span class="op">;</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="va">parameters</span> <span class="va">BETA</span> <span class="va">ALPHA</span> <span class="va">DELTA</span> <span class="va">RHO_A</span> <span class="va">SIGMA_A</span> <span class="va">CHI</span> <span class="va">PHI</span><span class="op">;</span></span>
<span id="cb7-6"><a href="#cb7-6"></a></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co">%% Calibration</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="va">BETA</span> <span class="op">=</span> <span class="fl">0.99</span><span class="op">;</span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="va">ALPHA</span> <span class="op">=</span> <span class="fl">0.33</span><span class="op">;</span></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="va">DELTA</span> <span class="op">=</span> <span class="fl">0.025</span><span class="op">;</span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="va">RHO_A</span> <span class="op">=</span> <span class="fl">0.95</span><span class="op">;</span></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="va">SIGMA_A</span> <span class="op">=</span> <span class="fl">0.007</span><span class="op">;</span></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="va">CHI</span> <span class="op">=</span> <span class="fl">1</span><span class="op">;</span>       <span class="co">% labor disutility</span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="va">PHI</span> <span class="op">=</span> <span class="fl">1</span><span class="op">;</span>       <span class="co">% inverse Frisch elasticity</span></span>
<span id="cb7-15"><a href="#cb7-15"></a></span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="co">%% Model equations</span></span>
<span id="cb7-17"><a href="#cb7-17"></a><span class="va">model</span><span class="op">;</span></span>
<span id="cb7-18"><a href="#cb7-18"></a>  <span class="co">% Euler equation</span></span>
<span id="cb7-19"><a href="#cb7-19"></a>  <span class="fl">1</span><span class="op">/</span><span class="va">c</span> <span class="op">=</span> <span class="va">BETA</span> <span class="op">*</span> (<span class="fl">1</span><span class="op">/</span><span class="va">c</span>(<span class="op">+</span><span class="fl">1</span>)) <span class="op">*</span> (<span class="va">r</span>(<span class="op">+</span><span class="fl">1</span>) <span class="op">+</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">DELTA</span>)<span class="op">;</span></span>
<span id="cb7-20"><a href="#cb7-20"></a></span>
<span id="cb7-21"><a href="#cb7-21"></a>  <span class="co">% Labor supply</span></span>
<span id="cb7-22"><a href="#cb7-22"></a>  <span class="va">CHI</span> <span class="op">*</span> <span class="va">n</span><span class="op">^</span><span class="va">PHI</span> <span class="op">*</span> <span class="va">c</span> <span class="op">=</span> <span class="va">w</span><span class="op">;</span></span>
<span id="cb7-23"><a href="#cb7-23"></a></span>
<span id="cb7-24"><a href="#cb7-24"></a>  <span class="co">% Production function</span></span>
<span id="cb7-25"><a href="#cb7-25"></a>  <span class="va">y</span> <span class="op">=</span> <span class="va">a</span> <span class="op">*</span> <span class="va">k</span>(<span class="op">-</span><span class="fl">1</span>)<span class="op">^</span><span class="va">ALPHA</span> <span class="op">*</span> <span class="va">n</span><span class="op">^</span>(<span class="fl">1</span><span class="op">-</span><span class="va">ALPHA</span>)<span class="op">;</span></span>
<span id="cb7-26"><a href="#cb7-26"></a></span>
<span id="cb7-27"><a href="#cb7-27"></a>  <span class="co">% Factor prices</span></span>
<span id="cb7-28"><a href="#cb7-28"></a>  <span class="va">w</span> <span class="op">=</span> (<span class="fl">1</span><span class="op">-</span><span class="va">ALPHA</span>) <span class="op">*</span> <span class="va">y</span> <span class="op">/</span> <span class="va">n</span><span class="op">;</span></span>
<span id="cb7-29"><a href="#cb7-29"></a>  <span class="va">r</span> <span class="op">=</span> <span class="va">ALPHA</span> <span class="op">*</span> <span class="va">y</span> <span class="op">/</span> <span class="va">k</span>(<span class="op">-</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb7-30"><a href="#cb7-30"></a></span>
<span id="cb7-31"><a href="#cb7-31"></a>  <span class="co">% Resource constraint</span></span>
<span id="cb7-32"><a href="#cb7-32"></a>  <span class="va">y</span> <span class="op">=</span> <span class="va">c</span> <span class="op">+</span> <span class="va">k</span> <span class="op">-</span> (<span class="fl">1</span><span class="op">-</span><span class="va">DELTA</span>)<span class="op">*</span><span class="va">k</span>(<span class="op">-</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb7-33"><a href="#cb7-33"></a></span>
<span id="cb7-34"><a href="#cb7-34"></a>  <span class="co">% Technology shock</span></span>
<span id="cb7-35"><a href="#cb7-35"></a>  <span class="va">log</span>(<span class="va">a</span>) <span class="op">=</span> <span class="va">RHO_A</span> <span class="op">*</span> <span class="va">log</span>(<span class="va">a</span>(<span class="op">-</span><span class="fl">1</span>)) <span class="op">+</span> <span class="va">eps_a</span><span class="op">;</span></span>
<span id="cb7-36"><a href="#cb7-36"></a><span class="kw">end</span><span class="op">;</span></span>
<span id="cb7-37"><a href="#cb7-37"></a></span>
<span id="cb7-38"><a href="#cb7-38"></a><span class="co">%% Steady state</span></span>
<span id="cb7-39"><a href="#cb7-39"></a><span class="va">initval</span><span class="op">;</span></span>
<span id="cb7-40"><a href="#cb7-40"></a>  <span class="va">a</span> <span class="op">=</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb7-41"><a href="#cb7-41"></a>  <span class="va">r</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">BETA</span> <span class="op">-</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">DELTA</span><span class="op">;</span></span>
<span id="cb7-42"><a href="#cb7-42"></a>  <span class="va">k</span> <span class="op">=</span> (<span class="va">ALPHA</span><span class="op">/</span><span class="va">r</span>)<span class="op">^</span>(<span class="fl">1</span><span class="op">/</span>(<span class="fl">1</span><span class="op">-</span><span class="va">ALPHA</span>)) <span class="op">*</span> <span class="fl">0.33</span><span class="op">;</span></span>
<span id="cb7-43"><a href="#cb7-43"></a>  <span class="va">n</span> <span class="op">=</span> <span class="fl">0.33</span><span class="op">;</span></span>
<span id="cb7-44"><a href="#cb7-44"></a>  <span class="va">y</span> <span class="op">=</span> <span class="va">a</span> <span class="op">*</span> <span class="va">k</span><span class="op">^</span><span class="va">ALPHA</span> <span class="op">*</span> <span class="va">n</span><span class="op">^</span>(<span class="fl">1</span><span class="op">-</span><span class="va">ALPHA</span>)<span class="op">;</span></span>
<span id="cb7-45"><a href="#cb7-45"></a>  <span class="va">c</span> <span class="op">=</span> <span class="va">y</span> <span class="op">-</span> <span class="va">DELTA</span><span class="op">*</span><span class="va">k</span><span class="op">;</span></span>
<span id="cb7-46"><a href="#cb7-46"></a>  <span class="va">w</span> <span class="op">=</span> (<span class="fl">1</span><span class="op">-</span><span class="va">ALPHA</span>) <span class="op">*</span> <span class="va">y</span> <span class="op">/</span> <span class="va">n</span><span class="op">;</span></span>
<span id="cb7-47"><a href="#cb7-47"></a><span class="kw">end</span><span class="op">;</span></span>
<span id="cb7-48"><a href="#cb7-48"></a></span>
<span id="cb7-49"><a href="#cb7-49"></a><span class="va">steady</span><span class="op">;</span></span>
<span id="cb7-50"><a href="#cb7-50"></a><span class="va">check</span><span class="op">;</span></span>
<span id="cb7-51"><a href="#cb7-51"></a></span>
<span id="cb7-52"><a href="#cb7-52"></a><span class="co">%% Shocks</span></span>
<span id="cb7-53"><a href="#cb7-53"></a><span class="va">shocks</span><span class="op">;</span></span>
<span id="cb7-54"><a href="#cb7-54"></a>  <span class="va">var</span> <span class="va">eps_a</span><span class="op">;</span> <span class="va">stderr</span> <span class="va">SIGMA_A</span><span class="op">;</span></span>
<span id="cb7-55"><a href="#cb7-55"></a><span class="kw">end</span><span class="op">;</span></span>
<span id="cb7-56"><a href="#cb7-56"></a></span>
<span id="cb7-57"><a href="#cb7-57"></a><span class="co">%% Simulation</span></span>
<span id="cb7-58"><a href="#cb7-58"></a><span class="va">stoch_simul</span>(<span class="va">order</span><span class="op">=</span><span class="fl">1</span><span class="op">,</span> <span class="va">irf</span><span class="op">=</span><span class="fl">40</span><span class="op">,</span> <span class="va">periods</span><span class="op">=</span><span class="fl">200</span>)<span class="op">;</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</section>
<section id="key-dynare-commands" class="level2">
<h2 class="anchored" data-anchor-id="key-dynare-commands">Key Dynare Commands</h2>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Command</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>steady</code></td>
<td>Compute deterministic steady state</td>
</tr>
<tr class="even">
<td><code>check</code></td>
<td>Verify Blanchard-Kahn conditions</td>
</tr>
<tr class="odd">
<td><code>stoch_simul(order=1)</code></td>
<td>First-order perturbation solution</td>
</tr>
<tr class="even">
<td><code>stoch_simul(irf=40)</code></td>
<td>Generate IRFs for 40 periods</td>
</tr>
<tr class="odd">
<td><code>estimation(...)</code></td>
<td>Bayesian estimation (Module 11)</td>
</tr>
<tr class="even">
<td><code>model_diagnostics</code></td>
<td>Check model specification</td>
</tr>
</tbody>
</table>
</section>
<section id="important-timing-convention" class="level2">
<h2 class="anchored" data-anchor-id="important-timing-convention">Important Timing Convention</h2>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Warning</span>Dynare Timing
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dynare uses <strong>end-of-period</strong> capital: - <code>k</code> without subscript = <span class="math inline">\(K_t\)</span> (end of period <span class="math inline">\(t\)</span>) - <code>k(-1)</code> = <span class="math inline">\(K_{t-1}\)</span> (beginning of period <span class="math inline">\(t\)</span> = end of <span class="math inline">\(t-1\)</span>)</p>
<p>So the production function uses <code>k(-1)</code>:</p>
<pre><code>y = a * k(-1)^ALPHA * n^(1-ALPHA);</code></pre>
</div>
</div>
</section>
</section>
<section id="summary" class="level1 unnumbered">
<h1 class="unnumbered">Summary</h1>
<table class="caption-top table">
<colgroup>
<col style="width: 40%">
<col style="width: 59%">
</colgroup>
<thead>
<tr class="header">
<th>Concept</th>
<th>Key Insight</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>DSGE structure</strong></td>
<td>Microfounded optimization → aggregate equilibrium</td>
</tr>
<tr class="even">
<td><strong>Households</strong></td>
<td>Euler equation governs intertemporal choice</td>
</tr>
<tr class="odd">
<td><strong>Firms (NK)</strong></td>
<td>Calvo pricing → forward-looking Phillips curve</td>
</tr>
<tr class="even">
<td><strong>Monetary policy</strong></td>
<td>Taylor rule with <span class="math inline">\(\phi_\pi &gt; 1\)</span> for stability</td>
</tr>
<tr class="odd">
<td><strong>Log-linearization</strong></td>
<td>Approximate around steady state for solution</td>
</tr>
<tr class="even">
<td><strong>Blanchard-Kahn</strong></td>
<td>Saddle-path stability requires correct eigenvalue count</td>
</tr>
<tr class="odd">
<td><strong>Calibration</strong></td>
<td>Match parameters to micro evidence and steady-state targets</td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Tip</span>Next Steps
</div>
</div>
<div class="callout-body-container callout-body">
<p>Module 11 covers <strong>DSGE estimation</strong>: - Bayesian methods with Metropolis-Hastings - The Kalman filter for likelihood evaluation - Model comparison via marginal likelihood - Dynare’s <code>estimation</code> command</p>
</div>
</div>
</section>
<section id="key-references" class="level1 unnumbered">
<h1 class="unnumbered">Key References</h1>
<section id="foundational" class="level2">
<h2 class="anchored" data-anchor-id="foundational">Foundational</h2>
<ul>
<li><strong>Kydland &amp; Prescott (1982)</strong> “Time to Build and Aggregate Fluctuations” Econometrica — RBC origins</li>
<li><strong>Blanchard &amp; Kahn (1980)</strong> “The Solution of Linear Difference Models” Econometrica — BK conditions</li>
<li><strong>Galí (2015)</strong> <em>Monetary Policy, Inflation, and the Business Cycle</em> — NK textbook</li>
</ul>
</section>
<section id="medium-scale-models" class="level2">
<h2 class="anchored" data-anchor-id="medium-scale-models">Medium-Scale Models</h2>
<ul>
<li><strong>Smets &amp; Wouters (2003, 2007)</strong> “An Estimated DSGE Model” — Benchmark estimated NK</li>
<li><strong>Christiano, Eichenbaum &amp; Evans (2005)</strong> “Nominal Rigidities” JPE — CEE model</li>
</ul>
</section>
<section id="solution-methods" class="level2">
<h2 class="anchored" data-anchor-id="solution-methods">Solution Methods</h2>
<ul>
<li><strong>Uhlig (1999)</strong> “A Toolkit for Analysing Nonlinear Dynamic Stochastic Models” — Perturbation</li>
<li><strong>Sims (2002)</strong> “Solving Linear Rational Expectations Models” — QZ decomposition</li>
</ul>
</section>
<section id="calibration-1" class="level2">
<h2 class="anchored" data-anchor-id="calibration-1">Calibration</h2>
<ul>
<li><strong>Cooley &amp; Prescott (1995)</strong> “Economic Growth and Business Cycles” — Calibration methodology</li>
<li><strong>Chari, Kehoe &amp; McGrattan (2007)</strong> “Business Cycle Accounting” Econometrica — Wedges approach</li>
</ul>
</section>
<section id="software" class="level2">
<h2 class="anchored" data-anchor-id="software">Software</h2>
<ul>
<li><strong>Adjemian et al.</strong> “Dynare” — Standard DSGE solver</li>
<li><strong>Herbst &amp; Schorfheide (2016)</strong> <em>Bayesian Estimation of DSGE Models</em> — Modern estimation</li>
</ul>


<!-- -->

<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-blanchard1980" class="csl-entry" role="listitem">
Blanchard, Olivier Jean, and Charles M Kahn. 1980. <span>“The Solution of Linear Difference Models Under Rational Expectations.”</span> <em>Econometrica</em> 48 (5): 1305–11.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/09_bayesian_panel.html" class="pagination-link" aria-label="Bayesian Panel Methods">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Bayesian Panel Methods</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/11_dsge_estimation.html" class="pagination-link" aria-label="DSGE Estimation">
        <span class="nav-page-text"><span class="chapter-title">DSGE Estimation</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="code-copy-outer-scaffold"><div class="sourceCode" id="cb9" data-shortcodes="false"><pre class="sourceCode numberSource markdown number-lines code-with-copy"><code class="sourceCode markdown"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">---</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="an">title:</span><span class="co"> "DSGE Foundations"</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="an">subtitle:</span><span class="co"> "Microfoundations, the New Keynesian Model, and Solution Methods"</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">---</span></span>
<span id="cb9-5"><a href="#cb9-5"></a></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="in">```{r}</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">#| label: setup</span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">#| include: false</span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="fu">library</span>(Matrix)</span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="in">```</span></span>
<span id="cb9-15"><a href="#cb9-15"></a></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="fu"># What is a DSGE Model? {.unnumbered}</span></span>
<span id="cb9-17"><a href="#cb9-17"></a></span>
<span id="cb9-18"><a href="#cb9-18"></a>**Dynamic Stochastic General Equilibrium** models are the workhorse of modern macroeconomics. They combine:</span>
<span id="cb9-19"><a href="#cb9-19"></a></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="pp">|</span> Component <span class="pp">|</span> Meaning <span class="pp">|</span></span>
<span id="cb9-21"><a href="#cb9-21"></a><span class="pp">|-----------|---------|</span></span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="pp">|</span> **Dynamic** <span class="pp">|</span> Agents optimize over time, considering future <span class="pp">|</span></span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="pp">|</span> **Stochastic** <span class="pp">|</span> Random shocks drive business cycle fluctuations <span class="pp">|</span></span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="pp">|</span> **General** <span class="pp">|</span> All markets (goods, labor, capital) interact <span class="pp">|</span></span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="pp">|</span> **Equilibrium** <span class="pp">|</span> Supply equals demand in every market <span class="pp">|</span></span>
<span id="cb9-26"><a href="#cb9-26"></a></span>
<span id="cb9-27"><a href="#cb9-27"></a>::: {.callout-note}</span>
<span id="cb9-28"><a href="#cb9-28"></a><span class="fu">## The Core Philosophy</span></span>
<span id="cb9-29"><a href="#cb9-29"></a>DSGE models are **microfounded**: aggregate behavior emerges from explicit optimization by households, firms, and policymakers. No ad hoc aggregate relationships.</span>
<span id="cb9-30"><a href="#cb9-30"></a>:::</span>
<span id="cb9-31"><a href="#cb9-31"></a></span>
<span id="cb9-32"><a href="#cb9-32"></a><span class="fu">## From Micro to Macro</span></span>
<span id="cb9-33"><a href="#cb9-33"></a></span>
<span id="cb9-36"><a href="#cb9-36"></a><span class="in">```{r}</span></span>
<span id="cb9-37"><a href="#cb9-37"></a><span class="co">#| label: dsge-structure</span></span>
<span id="cb9-38"><a href="#cb9-38"></a><span class="co">#| fig-cap: "DSGE model structure"</span></span>
<span id="cb9-39"><a href="#cb9-39"></a><span class="co">#| echo: false</span></span>
<span id="cb9-40"><a href="#cb9-40"></a></span>
<span id="cb9-41"><a href="#cb9-41"></a><span class="co"># Diagram of DSGE structure</span></span>
<span id="cb9-42"><a href="#cb9-42"></a>structure_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb9-43"><a href="#cb9-43"></a>  <span class="at">agent =</span> <span class="fu">c</span>(<span class="st">"Households"</span>, <span class="st">"Firms"</span>, <span class="st">"Central Bank"</span>, <span class="st">"Government"</span>),</span>
<span id="cb9-44"><a href="#cb9-44"></a>  <span class="at">decision =</span> <span class="fu">c</span>(<span class="st">"Consumption, Labor, Savings"</span>, <span class="st">"Production, Pricing, Investment"</span>,</span>
<span id="cb9-45"><a href="#cb9-45"></a>               <span class="st">"Interest Rate (Taylor Rule)"</span>, <span class="st">"Spending, Taxes, Debt"</span>),</span>
<span id="cb9-46"><a href="#cb9-46"></a>  <span class="at">key_equation =</span> <span class="fu">c</span>(<span class="st">"Euler Equation"</span>, <span class="st">"Phillips Curve"</span>, <span class="st">"Taylor Rule"</span>, <span class="st">"Budget Constraint"</span>),</span>
<span id="cb9-47"><a href="#cb9-47"></a>  <span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>),</span>
<span id="cb9-48"><a href="#cb9-48"></a>  <span class="at">y =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb9-49"><a href="#cb9-49"></a>)</span>
<span id="cb9-50"><a href="#cb9-50"></a></span>
<span id="cb9-51"><a href="#cb9-51"></a><span class="fu">ggplot</span>(structure_df, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb9-52"><a href="#cb9-52"></a>  <span class="fu">geom_tile</span>(<span class="at">width =</span> <span class="fl">0.9</span>, <span class="at">height =</span> <span class="fl">0.8</span>, <span class="at">fill =</span> <span class="st">"#3498db"</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb9-53"><a href="#cb9-53"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> agent), <span class="at">fontface =</span> <span class="st">"bold"</span>, <span class="at">vjust =</span> <span class="sc">-</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb9-54"><a href="#cb9-54"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> decision), <span class="at">size =</span> <span class="dv">3</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb9-55"><a href="#cb9-55"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="st">"→ "</span>, key_equation)), <span class="at">size =</span> <span class="fl">2.5</span>, <span class="at">vjust =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">"#e74c3c"</span>) <span class="sc">+</span></span>
<span id="cb9-56"><a href="#cb9-56"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>, <span class="dv">5</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="dv">1</span>, <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb9-57"><a href="#cb9-57"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"DSGE Model: Agents and Their Key Equations"</span>) <span class="sc">+</span></span>
<span id="cb9-58"><a href="#cb9-58"></a>  <span class="fu">theme_void</span>()</span>
<span id="cb9-59"><a href="#cb9-59"></a><span class="in">```</span></span>
<span id="cb9-60"><a href="#cb9-60"></a></span>
<span id="cb9-61"><a href="#cb9-61"></a><span class="fu">## The General Form</span></span>
<span id="cb9-62"><a href="#cb9-62"></a></span>
<span id="cb9-63"><a href="#cb9-63"></a>All DSGE models can be written as:</span>
<span id="cb9-64"><a href="#cb9-64"></a></span>
<span id="cb9-65"><a href="#cb9-65"></a>$$</span>
<span id="cb9-66"><a href="#cb9-66"></a>\mathbb{E}_t\left[f(y_{t+1}, y_t, y_{t-1}, u_t)\right] = 0</span>
<span id="cb9-67"><a href="#cb9-67"></a>$$</span>
<span id="cb9-68"><a href="#cb9-68"></a></span>
<span id="cb9-69"><a href="#cb9-69"></a>where:</span>
<span id="cb9-70"><a href="#cb9-70"></a></span>
<span id="cb9-71"><a href="#cb9-71"></a><span class="ss">- </span>$y_t$ = vector of endogenous variables (output, inflation, interest rate, capital, ...)</span>
<span id="cb9-72"><a href="#cb9-72"></a><span class="ss">- </span>$u_t$ = vector of exogenous shocks (technology, monetary, fiscal, ...)</span>
<span id="cb9-73"><a href="#cb9-73"></a><span class="ss">- </span>$f$ = system of equilibrium conditions (Euler equations, market clearing, ...)</span>
<span id="cb9-74"><a href="#cb9-74"></a><span class="ss">- </span>$\mathbb{E}_t$ = expectation conditional on time-$t$ information</span>
<span id="cb9-75"><a href="#cb9-75"></a></span>
<span id="cb9-76"><a href="#cb9-76"></a>The challenge: **solving for $y_t$ as a function of states and shocks**.</span>
<span id="cb9-77"><a href="#cb9-77"></a></span>
<span id="cb9-78"><a href="#cb9-78"></a><span class="fu"># The RBC Core {.unnumbered}</span></span>
<span id="cb9-79"><a href="#cb9-79"></a></span>
<span id="cb9-80"><a href="#cb9-80"></a>Before New Keynesian elements, we start with the **Real Business Cycle** foundation.</span>
<span id="cb9-81"><a href="#cb9-81"></a></span>
<span id="cb9-82"><a href="#cb9-82"></a><span class="fu">## Household Problem</span></span>
<span id="cb9-83"><a href="#cb9-83"></a></span>
<span id="cb9-84"><a href="#cb9-84"></a>A representative household maximizes expected lifetime utility:</span>
<span id="cb9-85"><a href="#cb9-85"></a></span>
<span id="cb9-86"><a href="#cb9-86"></a>$$</span>
<span id="cb9-87"><a href="#cb9-87"></a>\max_{<span class="sc">\{</span>C_t, N_t, K_t<span class="sc">\}</span>} \mathbb{E}_0 \sum_{t=0}^{\infty} \beta^t U(C_t, N_t)</span>
<span id="cb9-88"><a href="#cb9-88"></a>$$</span>
<span id="cb9-89"><a href="#cb9-89"></a></span>
<span id="cb9-90"><a href="#cb9-90"></a>**Subject to budget constraint**:</span>
<span id="cb9-91"><a href="#cb9-91"></a>$$</span>
<span id="cb9-92"><a href="#cb9-92"></a>C_t + K_t = W_t N_t + R_t^K K_{t-1} + \Pi_t - T_t + (1-\delta)K_{t-1}</span>
<span id="cb9-93"><a href="#cb9-93"></a>$$</span>
<span id="cb9-94"><a href="#cb9-94"></a></span>
<span id="cb9-95"><a href="#cb9-95"></a>where:</span>
<span id="cb9-96"><a href="#cb9-96"></a><span class="ss">- </span>$C_t$ = consumption</span>
<span id="cb9-97"><a href="#cb9-97"></a><span class="ss">- </span>$N_t$ = labor supply</span>
<span id="cb9-98"><a href="#cb9-98"></a><span class="ss">- </span>$K_t$ = end-of-period capital</span>
<span id="cb9-99"><a href="#cb9-99"></a><span class="ss">- </span>$W_t$ = real wage</span>
<span id="cb9-100"><a href="#cb9-100"></a><span class="ss">- </span>$R_t^K$ = rental rate on capital</span>
<span id="cb9-101"><a href="#cb9-101"></a><span class="ss">- </span>$\delta$ = depreciation rate</span>
<span id="cb9-102"><a href="#cb9-102"></a><span class="ss">- </span>$\Pi_t$ = firm profits</span>
<span id="cb9-103"><a href="#cb9-103"></a><span class="ss">- </span>$T_t$ = lump-sum taxes</span>
<span id="cb9-104"><a href="#cb9-104"></a></span>
<span id="cb9-105"><a href="#cb9-105"></a><span class="fu">### First-Order Conditions</span></span>
<span id="cb9-106"><a href="#cb9-106"></a></span>
<span id="cb9-107"><a href="#cb9-107"></a>**Euler equation** (intertemporal consumption choice):</span>
<span id="cb9-108"><a href="#cb9-108"></a>$$</span>
<span id="cb9-109"><a href="#cb9-109"></a>U_C(C_t, N_t) = \beta \mathbb{E}_t\left[U_C(C_{t+1}, N_{t+1}) \cdot (R_{t+1}^K + 1 - \delta)\right]</span>
<span id="cb9-110"><a href="#cb9-110"></a>$$</span>
<span id="cb9-111"><a href="#cb9-111"></a></span>
<span id="cb9-112"><a href="#cb9-112"></a>**Labor supply** (consumption-leisure trade-off):</span>
<span id="cb9-113"><a href="#cb9-113"></a>$$</span>
<span id="cb9-114"><a href="#cb9-114"></a>\frac{-U_N(C_t, N_t)}{U_C(C_t, N_t)} = W_t</span>
<span id="cb9-115"><a href="#cb9-115"></a>$$</span>
<span id="cb9-116"><a href="#cb9-116"></a></span>
<span id="cb9-117"><a href="#cb9-117"></a><span class="fu">### Example: Log Utility</span></span>
<span id="cb9-118"><a href="#cb9-118"></a></span>
<span id="cb9-119"><a href="#cb9-119"></a>With $U(C, N) = \log(C) - \chi \frac{N^{1+\phi}}{1+\phi}$:</span>
<span id="cb9-120"><a href="#cb9-120"></a></span>
<span id="cb9-121"><a href="#cb9-121"></a>$$</span>
<span id="cb9-122"><a href="#cb9-122"></a>\frac{1}{C_t} = \beta \mathbb{E}_t\left[\frac{1}{C_{t+1}} (R_{t+1}^K + 1 - \delta)\right]</span>
<span id="cb9-123"><a href="#cb9-123"></a>$$</span>
<span id="cb9-124"><a href="#cb9-124"></a></span>
<span id="cb9-125"><a href="#cb9-125"></a>$$</span>
<span id="cb9-126"><a href="#cb9-126"></a>\chi N_t^\phi \cdot C_t = W_t</span>
<span id="cb9-127"><a href="#cb9-127"></a>$$</span>
<span id="cb9-128"><a href="#cb9-128"></a></span>
<span id="cb9-131"><a href="#cb9-131"></a><span class="in">```{r}</span></span>
<span id="cb9-132"><a href="#cb9-132"></a><span class="co">#| label: euler-intuition</span></span>
<span id="cb9-133"><a href="#cb9-133"></a><span class="co">#| fig-cap: "Euler equation: optimal consumption smoothing"</span></span>
<span id="cb9-134"><a href="#cb9-134"></a></span>
<span id="cb9-135"><a href="#cb9-135"></a><span class="co"># Illustrate consumption smoothing</span></span>
<span id="cb9-136"><a href="#cb9-136"></a>beta <span class="ot">&lt;-</span> <span class="fl">0.99</span></span>
<span id="cb9-137"><a href="#cb9-137"></a>R_gross <span class="ot">&lt;-</span> <span class="fl">1.02</span>  <span class="co"># gross interest rate</span></span>
<span id="cb9-138"><a href="#cb9-138"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># CRRA coefficient</span></span>
<span id="cb9-139"><a href="#cb9-139"></a></span>
<span id="cb9-140"><a href="#cb9-140"></a><span class="co"># For sigma = 1 (log utility): C_t+1/C_t = (beta * R)</span></span>
<span id="cb9-141"><a href="#cb9-141"></a>growth_rate <span class="ot">&lt;-</span> beta <span class="sc">*</span> R_gross</span>
<span id="cb9-142"><a href="#cb9-142"></a></span>
<span id="cb9-143"><a href="#cb9-143"></a><span class="co"># Simulate consumption path with and without smoothing</span></span>
<span id="cb9-144"><a href="#cb9-144"></a>T_sim <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb9-145"><a href="#cb9-145"></a>income <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">10</span>), <span class="fu">rep</span>(<span class="fl">1.2</span>, <span class="dv">10</span>))  <span class="co"># income jumps at t=10</span></span>
<span id="cb9-146"><a href="#cb9-146"></a></span>
<span id="cb9-147"><a href="#cb9-147"></a><span class="co"># Without smoothing (hand-to-mouth)</span></span>
<span id="cb9-148"><a href="#cb9-148"></a>c_htm <span class="ot">&lt;-</span> income</span>
<span id="cb9-149"><a href="#cb9-149"></a></span>
<span id="cb9-150"><a href="#cb9-150"></a><span class="co"># With smoothing (optimal)</span></span>
<span id="cb9-151"><a href="#cb9-151"></a><span class="co"># Permanent income = average</span></span>
<span id="cb9-152"><a href="#cb9-152"></a>perm_inc <span class="ot">&lt;-</span> <span class="fu">mean</span>(income)</span>
<span id="cb9-153"><a href="#cb9-153"></a>c_smooth <span class="ot">&lt;-</span> <span class="fu">rep</span>(perm_inc, T_sim)</span>
<span id="cb9-154"><a href="#cb9-154"></a></span>
<span id="cb9-155"><a href="#cb9-155"></a>consumption_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb9-156"><a href="#cb9-156"></a>  <span class="at">t =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>T_sim, <span class="dv">2</span>),</span>
<span id="cb9-157"><a href="#cb9-157"></a>  <span class="at">consumption =</span> <span class="fu">c</span>(c_htm, c_smooth),</span>
<span id="cb9-158"><a href="#cb9-158"></a>  <span class="at">type =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Hand-to-mouth"</span>, <span class="st">"Euler optimal"</span>), <span class="at">each =</span> T_sim)</span>
<span id="cb9-159"><a href="#cb9-159"></a>)</span>
<span id="cb9-160"><a href="#cb9-160"></a></span>
<span id="cb9-161"><a href="#cb9-161"></a><span class="fu">ggplot</span>(consumption_df, <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> consumption, <span class="at">color =</span> type, <span class="at">linetype =</span> type)) <span class="sc">+</span></span>
<span id="cb9-162"><a href="#cb9-162"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb9-163"><a href="#cb9-163"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">10</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb9-164"><a href="#cb9-164"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">10.5</span>, <span class="at">y =</span> <span class="fl">1.15</span>, <span class="at">label =</span> <span class="st">"Income jump"</span>, <span class="at">hjust =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb9-165"><a href="#cb9-165"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#e74c3c"</span>, <span class="st">"#3498db"</span>)) <span class="sc">+</span></span>
<span id="cb9-166"><a href="#cb9-166"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Consumption Smoothing via the Euler Equation"</span>,</span>
<span id="cb9-167"><a href="#cb9-167"></a>       <span class="at">subtitle =</span> <span class="st">"Optimal: smooth consumption; Suboptimal: track income"</span>,</span>
<span id="cb9-168"><a href="#cb9-168"></a>       <span class="at">x =</span> <span class="st">"Period"</span>, <span class="at">y =</span> <span class="st">"Consumption"</span>, <span class="at">color =</span> <span class="cn">NULL</span>, <span class="at">linetype =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb9-169"><a href="#cb9-169"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-170"><a href="#cb9-170"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb9-171"><a href="#cb9-171"></a><span class="in">```</span></span>
<span id="cb9-172"><a href="#cb9-172"></a></span>
<span id="cb9-173"><a href="#cb9-173"></a><span class="fu">## Firm Problem</span></span>
<span id="cb9-174"><a href="#cb9-174"></a></span>
<span id="cb9-175"><a href="#cb9-175"></a>A representative firm maximizes profits with Cobb-Douglas production:</span>
<span id="cb9-176"><a href="#cb9-176"></a></span>
<span id="cb9-177"><a href="#cb9-177"></a>$$</span>
<span id="cb9-178"><a href="#cb9-178"></a>Y_t = A_t K_{t-1}^\alpha N_t^{1-\alpha}</span>
<span id="cb9-179"><a href="#cb9-179"></a>$$</span>
<span id="cb9-180"><a href="#cb9-180"></a></span>
<span id="cb9-181"><a href="#cb9-181"></a>**Factor demands** (competitive markets, firms are price-takers):</span>
<span id="cb9-182"><a href="#cb9-182"></a>$$</span>
<span id="cb9-183"><a href="#cb9-183"></a>W_t = (1-\alpha) \frac{Y_t}{N_t}</span>
<span id="cb9-184"><a href="#cb9-184"></a>$$</span>
<span id="cb9-185"><a href="#cb9-185"></a>$$</span>
<span id="cb9-186"><a href="#cb9-186"></a>R_t^K = \alpha \frac{Y_t}{K_{t-1}}</span>
<span id="cb9-187"><a href="#cb9-187"></a>$$</span>
<span id="cb9-188"><a href="#cb9-188"></a></span>
<span id="cb9-189"><a href="#cb9-189"></a>**Technology shock** follows AR(1):</span>
<span id="cb9-190"><a href="#cb9-190"></a>$$</span>
<span id="cb9-191"><a href="#cb9-191"></a>\log(A_t) = \rho_A \log(A_{t-1}) + \varepsilon_{A,t}, \quad \varepsilon_{A,t} \sim N(0, \sigma_A^2)</span>
<span id="cb9-192"><a href="#cb9-192"></a>$$</span>
<span id="cb9-193"><a href="#cb9-193"></a></span>
<span id="cb9-194"><a href="#cb9-194"></a><span class="fu">## Market Clearing</span></span>
<span id="cb9-195"><a href="#cb9-195"></a></span>
<span id="cb9-196"><a href="#cb9-196"></a>$$</span>
<span id="cb9-197"><a href="#cb9-197"></a>Y_t = C_t + I_t</span>
<span id="cb9-198"><a href="#cb9-198"></a>$$</span>
<span id="cb9-199"><a href="#cb9-199"></a></span>
<span id="cb9-200"><a href="#cb9-200"></a>where investment $I_t = K_t - (1-\delta)K_{t-1}$.</span>
<span id="cb9-201"><a href="#cb9-201"></a></span>
<span id="cb9-202"><a href="#cb9-202"></a><span class="fu">## The Complete RBC Model</span></span>
<span id="cb9-203"><a href="#cb9-203"></a></span>
<span id="cb9-204"><a href="#cb9-204"></a><span class="pp">|</span> Equation <span class="pp">|</span> Name <span class="pp">|</span> Variables <span class="pp">|</span></span>
<span id="cb9-205"><a href="#cb9-205"></a><span class="pp">|----------|------|-----------|</span></span>
<span id="cb9-206"><a href="#cb9-206"></a><span class="pp">|</span> $\frac{1}{C_t} = \beta \mathbb{E}_t\left[\frac{1}{C_{t+1}}(R_{t+1}^K + 1 - \delta)\right]$ <span class="pp">|</span> Euler <span class="pp">|</span> $C, R^K$ <span class="pp">|</span></span>
<span id="cb9-207"><a href="#cb9-207"></a><span class="pp">|</span> $\chi N_t^\phi C_t = W_t$ <span class="pp">|</span> Labor supply <span class="pp">|</span> $N, C, W$ <span class="pp">|</span></span>
<span id="cb9-208"><a href="#cb9-208"></a><span class="pp">|</span> $Y_t = A_t K_{t-1}^\alpha N_t^{1-\alpha}$ <span class="pp">|</span> Production <span class="pp">|</span> $Y, A, K, N$ <span class="pp">|</span></span>
<span id="cb9-209"><a href="#cb9-209"></a><span class="pp">|</span> $W_t = (1-\alpha) Y_t / N_t$ <span class="pp">|</span> Labor demand <span class="pp">|</span> $W, Y, N$ <span class="pp">|</span></span>
<span id="cb9-210"><a href="#cb9-210"></a><span class="pp">|</span> $R_t^K = \alpha Y_t / K_{t-1}$ <span class="pp">|</span> Capital demand <span class="pp">|</span> $R^K, Y, K$ <span class="pp">|</span></span>
<span id="cb9-211"><a href="#cb9-211"></a><span class="pp">|</span> $Y_t = C_t + K_t - (1-\delta)K_{t-1}$ <span class="pp">|</span> Resource <span class="pp">|</span> $Y, C, K$ <span class="pp">|</span></span>
<span id="cb9-212"><a href="#cb9-212"></a><span class="pp">|</span> $\log A_t = \rho_A \log A_{t-1} + \varepsilon_A$ <span class="pp">|</span> Technology <span class="pp">|</span> $A$ <span class="pp">|</span></span>
<span id="cb9-213"><a href="#cb9-213"></a></span>
<span id="cb9-214"><a href="#cb9-214"></a>**7 equations, 7 unknowns**: $(Y, C, N, K, W, R^K, A)$</span>
<span id="cb9-215"><a href="#cb9-215"></a></span>
<span id="cb9-216"><a href="#cb9-216"></a><span class="fu"># The New Keynesian Model {.unnumbered}</span></span>
<span id="cb9-217"><a href="#cb9-217"></a></span>
<span id="cb9-218"><a href="#cb9-218"></a>The RBC model has no role for monetary policy (all real). The **New Keynesian** model adds:</span>
<span id="cb9-219"><a href="#cb9-219"></a></span>
<span id="cb9-220"><a href="#cb9-220"></a><span class="ss">1. </span>**Nominal rigidities** (sticky prices/wages)</span>
<span id="cb9-221"><a href="#cb9-221"></a><span class="ss">2. </span>**Monopolistic competition** (firms have pricing power)</span>
<span id="cb9-222"><a href="#cb9-222"></a><span class="ss">3. </span>**Monetary policy** (central bank sets interest rate)</span>
<span id="cb9-223"><a href="#cb9-223"></a></span>
<span id="cb9-224"><a href="#cb9-224"></a><span class="fu">## The 3-Equation NK Model</span></span>
<span id="cb9-225"><a href="#cb9-225"></a></span>
<span id="cb9-226"><a href="#cb9-226"></a>The canonical log-linearized NK model:</span>
<span id="cb9-227"><a href="#cb9-227"></a></span>
<span id="cb9-228"><a href="#cb9-228"></a><span class="fu">### 1. IS Curve (Dynamic IS)</span></span>
<span id="cb9-229"><a href="#cb9-229"></a></span>
<span id="cb9-230"><a href="#cb9-230"></a>From the household's Euler equation:</span>
<span id="cb9-231"><a href="#cb9-231"></a>$$</span>
<span id="cb9-232"><a href="#cb9-232"></a>\hat{y}_t = \mathbb{E}_t[\hat{y}_{t+1}] - \frac{1}{\sigma}(i_t - \mathbb{E}_t[\pi_{t+1}] - r_t^n)</span>
<span id="cb9-233"><a href="#cb9-233"></a>$$</span>
<span id="cb9-234"><a href="#cb9-234"></a></span>
<span id="cb9-235"><a href="#cb9-235"></a>where:</span>
<span id="cb9-236"><a href="#cb9-236"></a><span class="ss">- </span>$\hat{y}_t$ = output gap (deviation from flexible-price equilibrium)</span>
<span id="cb9-237"><a href="#cb9-237"></a><span class="ss">- </span>$i_t$ = nominal interest rate</span>
<span id="cb9-238"><a href="#cb9-238"></a><span class="ss">- </span>$\pi_t$ = inflation</span>
<span id="cb9-239"><a href="#cb9-239"></a><span class="ss">- </span>$r_t^n$ = natural rate of interest</span>
<span id="cb9-240"><a href="#cb9-240"></a><span class="ss">- </span>$\sigma$ = inverse elasticity of intertemporal substitution</span>
<span id="cb9-241"><a href="#cb9-241"></a></span>
<span id="cb9-242"><a href="#cb9-242"></a>**Interpretation**: Higher real interest rate → postpone consumption → lower output today.</span>
<span id="cb9-243"><a href="#cb9-243"></a></span>
<span id="cb9-244"><a href="#cb9-244"></a><span class="fu">### 2. Phillips Curve (NKPC)</span></span>
<span id="cb9-245"><a href="#cb9-245"></a></span>
<span id="cb9-246"><a href="#cb9-246"></a>From **Calvo pricing** (fraction $1-\theta$ of firms adjust each period):</span>
<span id="cb9-247"><a href="#cb9-247"></a>$$</span>
<span id="cb9-248"><a href="#cb9-248"></a>\pi_t = \beta \mathbb{E}_t[\pi_{t+1}] + \kappa \hat{y}_t</span>
<span id="cb9-249"><a href="#cb9-249"></a>$$</span>
<span id="cb9-250"><a href="#cb9-250"></a></span>
<span id="cb9-251"><a href="#cb9-251"></a>where:</span>
<span id="cb9-252"><a href="#cb9-252"></a>$$</span>
<span id="cb9-253"><a href="#cb9-253"></a>\kappa = \frac{(1-\theta)(1-\beta\theta)}{\theta} \cdot (\sigma + \phi)</span>
<span id="cb9-254"><a href="#cb9-254"></a>$$</span>
<span id="cb9-255"><a href="#cb9-255"></a></span>
<span id="cb9-256"><a href="#cb9-256"></a>**Interpretation**: Inflation today depends on expected future inflation plus current output gap (marginal cost pressure).</span>
<span id="cb9-257"><a href="#cb9-257"></a></span>
<span id="cb9-258"><a href="#cb9-258"></a><span class="fu">### 3. Taylor Rule</span></span>
<span id="cb9-259"><a href="#cb9-259"></a></span>
<span id="cb9-260"><a href="#cb9-260"></a>Central bank sets interest rate:</span>
<span id="cb9-261"><a href="#cb9-261"></a>$$</span>
<span id="cb9-262"><a href="#cb9-262"></a>i_t = \rho_i i_{t-1} + (1-\rho_i)\left<span class="co">[</span><span class="ot">r^* + \phi_\pi(\pi_t - \pi^*) + \phi_y \hat{y}_t\right</span><span class="co">]</span> + \varepsilon_{m,t}</span>
<span id="cb9-263"><a href="#cb9-263"></a>$$</span>
<span id="cb9-264"><a href="#cb9-264"></a></span>
<span id="cb9-265"><a href="#cb9-265"></a>**Standard calibration**:</span>
<span id="cb9-266"><a href="#cb9-266"></a></span>
<span id="cb9-267"><a href="#cb9-267"></a><span class="pp">|</span> Parameter <span class="pp">|</span> Value <span class="pp">|</span> Interpretation <span class="pp">|</span></span>
<span id="cb9-268"><a href="#cb9-268"></a><span class="pp">|-----------|-------|----------------|</span></span>
<span id="cb9-269"><a href="#cb9-269"></a><span class="pp">|</span> $\rho_i$ <span class="pp">|</span> 0.8 <span class="pp">|</span> Interest rate smoothing <span class="pp">|</span></span>
<span id="cb9-270"><a href="#cb9-270"></a><span class="pp">|</span> $\phi_\pi$ <span class="pp">|</span> 1.5 <span class="pp">|</span> Response to inflation (**Taylor principle**: $\phi_\pi &gt; 1$) <span class="pp">|</span></span>
<span id="cb9-271"><a href="#cb9-271"></a><span class="pp">|</span> $\phi_y$ <span class="pp">|</span> 0.5/4 = 0.125 <span class="pp">|</span> Response to output gap (quarterly) <span class="pp">|</span></span>
<span id="cb9-272"><a href="#cb9-272"></a></span>
<span id="cb9-275"><a href="#cb9-275"></a><span class="in">```{r}</span></span>
<span id="cb9-276"><a href="#cb9-276"></a><span class="co">#| label: nk-3eq</span></span>
<span id="cb9-277"><a href="#cb9-277"></a><span class="co">#| fig-cap: "The 3-equation New Keynesian model"</span></span>
<span id="cb9-278"><a href="#cb9-278"></a></span>
<span id="cb9-279"><a href="#cb9-279"></a><span class="co"># Solve simple 3-eq NK model</span></span>
<span id="cb9-280"><a href="#cb9-280"></a><span class="co"># Parameters</span></span>
<span id="cb9-281"><a href="#cb9-281"></a>beta <span class="ot">&lt;-</span> <span class="fl">0.99</span></span>
<span id="cb9-282"><a href="#cb9-282"></a>sigma <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb9-283"><a href="#cb9-283"></a>kappa <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb9-284"><a href="#cb9-284"></a>phi_pi <span class="ot">&lt;-</span> <span class="fl">1.5</span></span>
<span id="cb9-285"><a href="#cb9-285"></a>phi_y <span class="ot">&lt;-</span> <span class="fl">0.125</span></span>
<span id="cb9-286"><a href="#cb9-286"></a>rho_i <span class="ot">&lt;-</span> <span class="fl">0.8</span></span>
<span id="cb9-287"><a href="#cb9-287"></a></span>
<span id="cb9-288"><a href="#cb9-288"></a><span class="co"># Monetary policy shock simulation</span></span>
<span id="cb9-289"><a href="#cb9-289"></a>T_sim <span class="ot">&lt;-</span> <span class="dv">40</span></span>
<span id="cb9-290"><a href="#cb9-290"></a>eps_m <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fu">rep</span>(<span class="dv">0</span>, T_sim <span class="sc">-</span> <span class="dv">2</span>))  <span class="co"># 25bp shock at t=2</span></span>
<span id="cb9-291"><a href="#cb9-291"></a></span>
<span id="cb9-292"><a href="#cb9-292"></a><span class="co"># Initialize</span></span>
<span id="cb9-293"><a href="#cb9-293"></a>y_gap <span class="ot">&lt;-</span> pi <span class="ot">&lt;-</span> i_rate <span class="ot">&lt;-</span> <span class="fu">numeric</span>(T_sim)</span>
<span id="cb9-294"><a href="#cb9-294"></a>y_gap[<span class="dv">1</span>] <span class="ot">&lt;-</span> pi[<span class="dv">1</span>] <span class="ot">&lt;-</span> i_rate[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-295"><a href="#cb9-295"></a></span>
<span id="cb9-296"><a href="#cb9-296"></a><span class="co"># Simple forward-looking solution (assuming expectations = 0 for simplicity)</span></span>
<span id="cb9-297"><a href="#cb9-297"></a><span class="co"># More rigorous: use Blanchard-Kahn</span></span>
<span id="cb9-298"><a href="#cb9-298"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>T_sim) {</span>
<span id="cb9-299"><a href="#cb9-299"></a>  <span class="co"># Taylor rule</span></span>
<span id="cb9-300"><a href="#cb9-300"></a>  i_rate[t] <span class="ot">&lt;-</span> rho_i <span class="sc">*</span> i_rate[t<span class="dv">-1</span>] <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">-</span> rho_i) <span class="sc">*</span> (phi_pi <span class="sc">*</span> pi[t<span class="dv">-1</span>] <span class="sc">+</span> phi_y <span class="sc">*</span> y_gap[t<span class="dv">-1</span>]) <span class="sc">+</span> eps_m[t]</span>
<span id="cb9-301"><a href="#cb9-301"></a></span>
<span id="cb9-302"><a href="#cb9-302"></a>  <span class="co"># IS curve (simplified: E[y+1] = 0, E[pi+1] = 0)</span></span>
<span id="cb9-303"><a href="#cb9-303"></a>  y_gap[t] <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">1</span><span class="sc">/</span>sigma <span class="sc">*</span> (i_rate[t] <span class="sc">-</span> <span class="dv">0</span> <span class="sc">-</span> <span class="dv">0</span>) <span class="sc">+</span> <span class="fl">0.7</span> <span class="sc">*</span> y_gap[t<span class="dv">-1</span>]</span>
<span id="cb9-304"><a href="#cb9-304"></a></span>
<span id="cb9-305"><a href="#cb9-305"></a>  <span class="co"># Phillips curve</span></span>
<span id="cb9-306"><a href="#cb9-306"></a>  pi[t] <span class="ot">&lt;-</span> beta <span class="sc">*</span> <span class="dv">0</span> <span class="sc">+</span> kappa <span class="sc">*</span> y_gap[t] <span class="sc">+</span> <span class="fl">0.5</span> <span class="sc">*</span> pi[t<span class="dv">-1</span>]</span>
<span id="cb9-307"><a href="#cb9-307"></a>}</span>
<span id="cb9-308"><a href="#cb9-308"></a></span>
<span id="cb9-309"><a href="#cb9-309"></a>nk_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb9-310"><a href="#cb9-310"></a>  <span class="at">t =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>T_sim, <span class="dv">3</span>),</span>
<span id="cb9-311"><a href="#cb9-311"></a>  <span class="at">value =</span> <span class="fu">c</span>(y_gap <span class="sc">*</span> <span class="dv">100</span>, pi <span class="sc">*</span> <span class="dv">100</span>, i_rate <span class="sc">*</span> <span class="dv">100</span>),</span>
<span id="cb9-312"><a href="#cb9-312"></a>  <span class="at">variable =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Output Gap (%)"</span>, <span class="st">"Inflation (%)"</span>, <span class="st">"Interest Rate (%)"</span>), <span class="at">each =</span> T_sim)</span>
<span id="cb9-313"><a href="#cb9-313"></a>)</span>
<span id="cb9-314"><a href="#cb9-314"></a></span>
<span id="cb9-315"><a href="#cb9-315"></a><span class="fu">ggplot</span>(nk_df, <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> value, <span class="at">color =</span> variable)) <span class="sc">+</span></span>
<span id="cb9-316"><a href="#cb9-316"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9-317"><a href="#cb9-317"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb9-318"><a href="#cb9-318"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>variable, <span class="at">scales =</span> <span class="st">"free_y"</span>, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb9-319"><a href="#cb9-319"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Response to 25bp Monetary Policy Shock"</span>,</span>
<span id="cb9-320"><a href="#cb9-320"></a>       <span class="at">subtitle =</span> <span class="st">"Simplified 3-equation NK model"</span>,</span>
<span id="cb9-321"><a href="#cb9-321"></a>       <span class="at">x =</span> <span class="st">"Quarters"</span>, <span class="at">y =</span> <span class="st">"Percent deviation"</span>) <span class="sc">+</span></span>
<span id="cb9-322"><a href="#cb9-322"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#3498db"</span>, <span class="st">"#e74c3c"</span>, <span class="st">"#2ecc71"</span>)) <span class="sc">+</span></span>
<span id="cb9-323"><a href="#cb9-323"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-324"><a href="#cb9-324"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb9-325"><a href="#cb9-325"></a><span class="in">```</span></span>
<span id="cb9-326"><a href="#cb9-326"></a></span>
<span id="cb9-327"><a href="#cb9-327"></a><span class="fu">## Deriving the Phillips Curve</span></span>
<span id="cb9-328"><a href="#cb9-328"></a></span>
<span id="cb9-329"><a href="#cb9-329"></a><span class="fu">### Calvo Pricing Setup</span></span>
<span id="cb9-330"><a href="#cb9-330"></a></span>
<span id="cb9-331"><a href="#cb9-331"></a><span class="ss">- </span>Each period, fraction $1-\theta$ of firms can reset prices</span>
<span id="cb9-332"><a href="#cb9-332"></a><span class="ss">- </span>Fraction $\theta$ are "stuck" with last period's price</span>
<span id="cb9-333"><a href="#cb9-333"></a><span class="ss">- </span>When firms can adjust, they set price to maximize expected profits over the time they'll be stuck</span>
<span id="cb9-334"><a href="#cb9-334"></a></span>
<span id="cb9-335"><a href="#cb9-335"></a><span class="fu">### Optimal Price Setting</span></span>
<span id="cb9-336"><a href="#cb9-336"></a></span>
<span id="cb9-337"><a href="#cb9-337"></a>A firm that can adjust at time $t$ chooses $P_t^*$ to maximize:</span>
<span id="cb9-338"><a href="#cb9-338"></a>$$</span>
<span id="cb9-339"><a href="#cb9-339"></a>\mathbb{E}_t \sum_{k=0}^{\infty} (\beta\theta)^k \left[ \frac{P_t^*}{P_{t+k}} Y_{t+k|t} - MC_{t+k} Y_{t+k|t} \right]</span>
<span id="cb9-340"><a href="#cb9-340"></a>$$</span>
<span id="cb9-341"><a href="#cb9-341"></a></span>
<span id="cb9-342"><a href="#cb9-342"></a>**Result** (after log-linearization):</span>
<span id="cb9-343"><a href="#cb9-343"></a>$$</span>
<span id="cb9-344"><a href="#cb9-344"></a>\hat{p}_t^* = (1-\beta\theta) \sum_{k=0}^{\infty} (\beta\theta)^k \mathbb{E}_t[\widehat{mc}_{t+k}]</span>
<span id="cb9-345"><a href="#cb9-345"></a>$$</span>
<span id="cb9-346"><a href="#cb9-346"></a></span>
<span id="cb9-347"><a href="#cb9-347"></a>Firms set prices as a weighted average of expected future marginal costs.</span>
<span id="cb9-348"><a href="#cb9-348"></a></span>
<span id="cb9-349"><a href="#cb9-349"></a><span class="fu">### Aggregating to the Phillips Curve</span></span>
<span id="cb9-350"><a href="#cb9-350"></a></span>
<span id="cb9-351"><a href="#cb9-351"></a>Price index evolution:</span>
<span id="cb9-352"><a href="#cb9-352"></a>$$</span>
<span id="cb9-353"><a href="#cb9-353"></a>P_t = \left<span class="co">[</span><span class="ot">\theta P_{t-1}^{1-\epsilon} + (1-\theta)(P_t^*)^{1-\epsilon}\right</span><span class="co">]</span>^{\frac{1}{1-\epsilon}}</span>
<span id="cb9-354"><a href="#cb9-354"></a>$$</span>
<span id="cb9-355"><a href="#cb9-355"></a></span>
<span id="cb9-356"><a href="#cb9-356"></a>Log-linearizing and combining:</span>
<span id="cb9-357"><a href="#cb9-357"></a>$$</span>
<span id="cb9-358"><a href="#cb9-358"></a>\pi_t = \beta \mathbb{E}_t[\pi_{t+1}] + \kappa \cdot \widehat{mc}_t</span>
<span id="cb9-359"><a href="#cb9-359"></a>$$</span>
<span id="cb9-360"><a href="#cb9-360"></a></span>
<span id="cb9-361"><a href="#cb9-361"></a>With $\widehat{mc}_t \propto \hat{y}_t$ (output gap approximates marginal cost deviations).</span>
<span id="cb9-362"><a href="#cb9-362"></a></span>
<span id="cb9-363"><a href="#cb9-363"></a><span class="fu"># Log-Linearization {.unnumbered}</span></span>
<span id="cb9-364"><a href="#cb9-364"></a></span>
<span id="cb9-365"><a href="#cb9-365"></a>DSGE models are nonlinear. To solve them analytically (or with first-order perturbation), we **log-linearize** around the steady state.</span>
<span id="cb9-366"><a href="#cb9-366"></a></span>
<span id="cb9-367"><a href="#cb9-367"></a><span class="fu">## The Technique</span></span>
<span id="cb9-368"><a href="#cb9-368"></a></span>
<span id="cb9-369"><a href="#cb9-369"></a>For any variable $X_t$:</span>
<span id="cb9-370"><a href="#cb9-370"></a></span>
<span id="cb9-371"><a href="#cb9-371"></a>$$</span>
<span id="cb9-372"><a href="#cb9-372"></a>\hat{x}_t \equiv \log(X_t) - \log(\bar{X}) = \log\left(\frac{X_t}{\bar{X}}\right) \approx \frac{X_t - \bar{X}}{\bar{X}}</span>
<span id="cb9-373"><a href="#cb9-373"></a>$$</span>
<span id="cb9-374"><a href="#cb9-374"></a></span>
<span id="cb9-375"><a href="#cb9-375"></a>So $\hat{x}_t$ is the **percentage deviation from steady state**.</span>
<span id="cb9-376"><a href="#cb9-376"></a></span>
<span id="cb9-377"><a href="#cb9-377"></a><span class="fu">### Key Approximation</span></span>
<span id="cb9-378"><a href="#cb9-378"></a></span>
<span id="cb9-379"><a href="#cb9-379"></a>For any function $f(X_t, Y_t)$:</span>
<span id="cb9-380"><a href="#cb9-380"></a>$$</span>
<span id="cb9-381"><a href="#cb9-381"></a>f(X_t, Y_t) \approx f(\bar{X}, \bar{Y}) + f_X(\bar{X}, \bar{Y})(X_t - \bar{X}) + f_Y(\bar{X}, \bar{Y})(Y_t - \bar{Y})</span>
<span id="cb9-382"><a href="#cb9-382"></a>$$</span>
<span id="cb9-383"><a href="#cb9-383"></a></span>
<span id="cb9-384"><a href="#cb9-384"></a><span class="fu">### Example: Euler Equation</span></span>
<span id="cb9-385"><a href="#cb9-385"></a></span>
<span id="cb9-386"><a href="#cb9-386"></a>Nonlinear Euler:</span>
<span id="cb9-387"><a href="#cb9-387"></a>$$</span>
<span id="cb9-388"><a href="#cb9-388"></a>\frac{1}{C_t} = \beta \mathbb{E}_t\left[\frac{1}{C_{t+1}} R_{t+1}\right]</span>
<span id="cb9-389"><a href="#cb9-389"></a>$$</span>
<span id="cb9-390"><a href="#cb9-390"></a></span>
<span id="cb9-391"><a href="#cb9-391"></a>**Step 1**: Steady state</span>
<span id="cb9-392"><a href="#cb9-392"></a>$$</span>
<span id="cb9-393"><a href="#cb9-393"></a>\frac{1}{\bar{C}} = \beta \frac{1}{\bar{C}} \bar{R} \implies \bar{R} = \frac{1}{\beta}</span>
<span id="cb9-394"><a href="#cb9-394"></a>$$</span>
<span id="cb9-395"><a href="#cb9-395"></a></span>
<span id="cb9-396"><a href="#cb9-396"></a>**Step 2**: Log-linearize. Let $C_t = \bar{C} e^{\hat{c}_t} \approx \bar{C}(1 + \hat{c}_t)$:</span>
<span id="cb9-397"><a href="#cb9-397"></a>$$</span>
<span id="cb9-398"><a href="#cb9-398"></a>\frac{1}{\bar{C}(1 + \hat{c}_t)} = \beta \mathbb{E}_t\left[\frac{1}{\bar{C}(1 + \hat{c}_{t+1})} \bar{R}(1 + \hat{r}_{t+1})\right]</span>
<span id="cb9-399"><a href="#cb9-399"></a>$$</span>
<span id="cb9-400"><a href="#cb9-400"></a></span>
<span id="cb9-401"><a href="#cb9-401"></a>**Step 3**: First-order Taylor expansion (ignore second-order terms):</span>
<span id="cb9-402"><a href="#cb9-402"></a>$$</span>
<span id="cb9-403"><a href="#cb9-403"></a>1 - \hat{c}_t = \beta \bar{R} \mathbb{E}_t\left[(1 - \hat{c}_{t+1})(1 + \hat{r}_{t+1})\right]</span>
<span id="cb9-404"><a href="#cb9-404"></a>$$</span>
<span id="cb9-405"><a href="#cb9-405"></a>$$</span>
<span id="cb9-406"><a href="#cb9-406"></a>1 - \hat{c}_t \approx \mathbb{E}_t[1 - \hat{c}_{t+1} + \hat{r}_{t+1}]</span>
<span id="cb9-407"><a href="#cb9-407"></a>$$</span>
<span id="cb9-408"><a href="#cb9-408"></a></span>
<span id="cb9-409"><a href="#cb9-409"></a>**Result**:</span>
<span id="cb9-410"><a href="#cb9-410"></a>$$</span>
<span id="cb9-411"><a href="#cb9-411"></a>\hat{c}_t = \mathbb{E}_t[\hat{c}_{t+1}] - (\hat{r}_{t+1} - 0)</span>
<span id="cb9-412"><a href="#cb9-412"></a>$$</span>
<span id="cb9-413"><a href="#cb9-413"></a></span>
<span id="cb9-414"><a href="#cb9-414"></a>This is the **log-linearized Euler equation** (with $\sigma = 1$).</span>
<span id="cb9-415"><a href="#cb9-415"></a></span>
<span id="cb9-418"><a href="#cb9-418"></a><span class="in">```{r}</span></span>
<span id="cb9-419"><a href="#cb9-419"></a><span class="co">#| label: log-lin-demo</span></span>
<span id="cb9-420"><a href="#cb9-420"></a><span class="co">#| fig-cap: "Log-linearization accuracy"</span></span>
<span id="cb9-421"><a href="#cb9-421"></a></span>
<span id="cb9-422"><a href="#cb9-422"></a><span class="co"># Compare nonlinear vs log-linear Euler</span></span>
<span id="cb9-423"><a href="#cb9-423"></a>C_ss <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb9-424"><a href="#cb9-424"></a>beta <span class="ot">&lt;-</span> <span class="fl">0.99</span></span>
<span id="cb9-425"><a href="#cb9-425"></a>R_ss <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>beta</span>
<span id="cb9-426"><a href="#cb9-426"></a></span>
<span id="cb9-427"><a href="#cb9-427"></a><span class="co"># Deviations from steady state</span></span>
<span id="cb9-428"><a href="#cb9-428"></a>c_dev <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.01</span>)</span>
<span id="cb9-429"><a href="#cb9-429"></a></span>
<span id="cb9-430"><a href="#cb9-430"></a><span class="co"># Nonlinear: U'(C) = 1/C</span></span>
<span id="cb9-431"><a href="#cb9-431"></a>uprime_nonlinear <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> (C_ss <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">+</span> c_dev))</span>
<span id="cb9-432"><a href="#cb9-432"></a></span>
<span id="cb9-433"><a href="#cb9-433"></a><span class="co"># Log-linear: U'(C) ≈ 1/C_ss * (1 - c_dev)</span></span>
<span id="cb9-434"><a href="#cb9-434"></a>uprime_linear <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">/</span>C_ss) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> c_dev)</span>
<span id="cb9-435"><a href="#cb9-435"></a></span>
<span id="cb9-436"><a href="#cb9-436"></a>approx_df <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb9-437"><a href="#cb9-437"></a>  <span class="at">deviation =</span> <span class="fu">rep</span>(c_dev <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">2</span>),</span>
<span id="cb9-438"><a href="#cb9-438"></a>  <span class="at">marginal_utility =</span> <span class="fu">c</span>(uprime_nonlinear, uprime_linear),</span>
<span id="cb9-439"><a href="#cb9-439"></a>  <span class="at">method =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">"Nonlinear"</span>, <span class="st">"Log-linear"</span>), <span class="at">each =</span> <span class="fu">length</span>(c_dev))</span>
<span id="cb9-440"><a href="#cb9-440"></a>)</span>
<span id="cb9-441"><a href="#cb9-441"></a></span>
<span id="cb9-442"><a href="#cb9-442"></a><span class="fu">ggplot</span>(approx_df, <span class="fu">aes</span>(<span class="at">x =</span> deviation, <span class="at">y =</span> marginal_utility, <span class="at">color =</span> method)) <span class="sc">+</span></span>
<span id="cb9-443"><a href="#cb9-443"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb9-444"><a href="#cb9-444"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb9-445"><a href="#cb9-445"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Log-Linearization Accuracy"</span>,</span>
<span id="cb9-446"><a href="#cb9-446"></a>       <span class="at">subtitle =</span> <span class="st">"Approximation works well for small deviations (±10%)"</span>,</span>
<span id="cb9-447"><a href="#cb9-447"></a>       <span class="at">x =</span> <span class="st">"% Deviation from Steady State"</span>,</span>
<span id="cb9-448"><a href="#cb9-448"></a>       <span class="at">y =</span> <span class="st">"Marginal Utility U'(C)"</span>, <span class="at">color =</span> <span class="cn">NULL</span>) <span class="sc">+</span></span>
<span id="cb9-449"><a href="#cb9-449"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#3498db"</span>, <span class="st">"#e74c3c"</span>)) <span class="sc">+</span></span>
<span id="cb9-450"><a href="#cb9-450"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb9-451"><a href="#cb9-451"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"bottom"</span>)</span>
<span id="cb9-452"><a href="#cb9-452"></a><span class="in">```</span></span>
<span id="cb9-453"><a href="#cb9-453"></a></span>
<span id="cb9-454"><a href="#cb9-454"></a><span class="fu"># Solving Rational Expectations Models {.unnumbered}</span></span>
<span id="cb9-455"><a href="#cb9-455"></a></span>
<span id="cb9-456"><a href="#cb9-456"></a>After log-linearization, DSGE models take the form:</span>
<span id="cb9-457"><a href="#cb9-457"></a></span>
<span id="cb9-458"><a href="#cb9-458"></a>$$</span>
<span id="cb9-459"><a href="#cb9-459"></a>A \mathbb{E}_t[y_{t+1}] = B y_t + C u_t</span>
<span id="cb9-460"><a href="#cb9-460"></a>$$</span>
<span id="cb9-461"><a href="#cb9-461"></a></span>
<span id="cb9-462"><a href="#cb9-462"></a>where $y_t$ contains both **predetermined** (state) and **jump** (control) variables.</span>
<span id="cb9-463"><a href="#cb9-463"></a></span>
<span id="cb9-464"><a href="#cb9-464"></a><span class="fu">## Partitioning the System</span></span>
<span id="cb9-465"><a href="#cb9-465"></a></span>
<span id="cb9-466"><a href="#cb9-466"></a>Split $y_t = \begin{pmatrix} x_t <span class="sc">\\</span> z_t \end{pmatrix}$ where:</span>
<span id="cb9-467"><a href="#cb9-467"></a></span>
<span id="cb9-468"><a href="#cb9-468"></a><span class="ss">- </span>$x_t$: **Predetermined** (state) variables — known at time $t$ (e.g., capital $K_{t-1}$)</span>
<span id="cb9-469"><a href="#cb9-469"></a><span class="ss">- </span>$z_t$: **Jump** (forward-looking) variables — can adjust freely (e.g., consumption, inflation)</span>
<span id="cb9-470"><a href="#cb9-470"></a></span>
<span id="cb9-471"><a href="#cb9-471"></a><span class="fu">## Blanchard-Kahn Conditions</span></span>
<span id="cb9-472"><a href="#cb9-472"></a></span>
<span id="cb9-473"><a href="#cb9-473"></a>The **eigenvalue decomposition** of the system matrix determines solvability <span class="co">[</span><span class="ot">@blanchard1980</span><span class="co">]</span>.</span>
<span id="cb9-474"><a href="#cb9-474"></a></span>
<span id="cb9-475"><a href="#cb9-475"></a>::: {.callout-important}</span>
<span id="cb9-476"><a href="#cb9-476"></a><span class="fu">## Blanchard-Kahn (1980) Conditions</span></span>
<span id="cb9-477"><a href="#cb9-477"></a></span>
<span id="cb9-478"><a href="#cb9-478"></a>For a unique stable solution:</span>
<span id="cb9-479"><a href="#cb9-479"></a></span>
<span id="cb9-480"><a href="#cb9-480"></a><span class="at">&gt; **Number of eigenvalues outside unit circle = Number of jump variables**</span></span>
<span id="cb9-481"><a href="#cb9-481"></a><span class="at">:::</span></span>
<span id="cb9-482"><a href="#cb9-482"></a></span>
<span id="cb9-483"><a href="#cb9-483"></a><span class="pp">|</span> Eigenvalue Count <span class="pp">|</span> Diagnosis <span class="pp">|</span></span>
<span id="cb9-484"><a href="#cb9-484"></a><span class="pp">|------------------|-----------|</span></span>
<span id="cb9-485"><a href="#cb9-485"></a><span class="pp">|</span> Equals number of jump vars <span class="pp">|</span> **Unique solution** (saddle-path stable) <span class="pp">|</span></span>
<span id="cb9-486"><a href="#cb9-486"></a><span class="pp">|</span> Less than number of jump vars <span class="pp">|</span> **Indeterminacy** (multiple equilibria, sunspots) <span class="pp">|</span></span>
<span id="cb9-487"><a href="#cb9-487"></a><span class="pp">|</span> Greater than number of jump vars <span class="pp">|</span> **No solution** (explosive dynamics) <span class="pp">|</span></span>
<span id="cb9-488"><a href="#cb9-488"></a></span>
<span id="cb9-489"><a href="#cb9-489"></a><span class="fu">## The Solution Form</span></span>
<span id="cb9-490"><a href="#cb9-490"></a></span>
<span id="cb9-491"><a href="#cb9-491"></a>If BK conditions hold, the solution is:</span>
<span id="cb9-492"><a href="#cb9-492"></a></span>
<span id="cb9-493"><a href="#cb9-493"></a>$$</span>
<span id="cb9-494"><a href="#cb9-494"></a>x_{t+1} = H_x x_t + H_u u_{t+1}</span>
<span id="cb9-495"><a href="#cb9-495"></a>$$</span>
<span id="cb9-496"><a href="#cb9-496"></a>$$</span>
<span id="cb9-497"><a href="#cb9-497"></a>z_t = G_x x_t</span>
<span id="cb9-498"><a href="#cb9-498"></a>$$</span>
<span id="cb9-499"><a href="#cb9-499"></a></span>
<span id="cb9-500"><a href="#cb9-500"></a>The **policy function** $G_x$ tells us how jump variables respond to states.</span>
<span id="cb9-501"><a href="#cb9-501"></a>The **transition matrix** $H_x$ governs state evolution.</span>
<span id="cb9-502"><a href="#cb9-502"></a></span>
<span id="cb9-505"><a href="#cb9-505"></a><span class="in">```{r}</span></span>
<span id="cb9-506"><a href="#cb9-506"></a><span class="co">#| label: bk-illustration</span></span>
<span id="cb9-507"><a href="#cb9-507"></a><span class="co">#| fig-cap: "Blanchard-Kahn: saddle-path stability"</span></span>
<span id="cb9-508"><a href="#cb9-508"></a></span>
<span id="cb9-509"><a href="#cb9-509"></a><span class="co"># Illustrate saddle-path in a simple 2-variable system</span></span>
<span id="cb9-510"><a href="#cb9-510"></a><span class="co"># x_t = state (capital), z_t = control (consumption)</span></span>
<span id="cb9-511"><a href="#cb9-511"></a></span>
<span id="cb9-512"><a href="#cb9-512"></a><span class="co"># Phase diagram for consumption-capital</span></span>
<span id="cb9-513"><a href="#cb9-513"></a>k_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">0.02</span>)</span>
<span id="cb9-514"><a href="#cb9-514"></a>c_grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">0.02</span>)</span>
<span id="cb9-515"><a href="#cb9-515"></a></span>
<span id="cb9-516"><a href="#cb9-516"></a><span class="co"># Steady state (normalized)</span></span>
<span id="cb9-517"><a href="#cb9-517"></a>k_ss <span class="ot">&lt;-</span> c_ss <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb9-518"><a href="#cb9-518"></a></span>
<span id="cb9-519"><a href="#cb9-519"></a><span class="co"># Simplified dynamics for illustration</span></span>
<span id="cb9-520"><a href="#cb9-520"></a><span class="co"># dk/dt = 0 locus: c = f(k) - delta*k</span></span>
<span id="cb9-521"><a href="#cb9-521"></a><span class="co"># dc/dt = 0 locus: f'(k) = rho + delta</span></span>
<span id="cb9-522"><a href="#cb9-522"></a></span>
<span id="cb9-523"><a href="#cb9-523"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.33</span></span>
<span id="cb9-524"><a href="#cb9-524"></a>delta <span class="ot">&lt;-</span> <span class="fl">0.025</span></span>
<span id="cb9-525"><a href="#cb9-525"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb9-526"><a href="#cb9-526"></a></span>
<span id="cb9-527"><a href="#cb9-527"></a><span class="co"># Nullclines</span></span>
<span id="cb9-528"><a href="#cb9-528"></a>c_from_k_nullcline <span class="ot">&lt;-</span> <span class="cf">function</span>(k) k<span class="sc">^</span>alpha <span class="sc">-</span> delta <span class="sc">*</span> k</span>
<span id="cb9-529"><a href="#cb9-529"></a>k_from_c_nullcline <span class="ot">&lt;-</span> (alpha <span class="sc">/</span> (rho <span class="sc">+</span> delta))<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">-</span>alpha))</span>
<span id="cb9-530"><a href="#cb9-530"></a></span>
<span id="cb9-531"><a href="#cb9-531"></a><span class="co"># Create phase diagram</span></span>
<span id="cb9-532"><a href="#cb9-532"></a>phase_df <span class="ot">&lt;-</span> <span class="fu">expand_grid</span>(<span class="at">k =</span> k_grid, <span class="at">c =</span> c_grid) <span class="sc">%&gt;%</span></span>
<span id="cb9-533"><a href="#cb9-533"></a>  <span class="fu">mutate</span>(</span>
<span id="cb9-534"><a href="#cb9-534"></a>    <span class="at">dk =</span> k<span class="sc">^</span>alpha <span class="sc">-</span> c <span class="sc">-</span> delta <span class="sc">*</span> k,</span>
<span id="cb9-535"><a href="#cb9-535"></a>    <span class="at">dc =</span> (alpha <span class="sc">*</span> k<span class="sc">^</span>(alpha<span class="dv">-1</span>) <span class="sc">-</span> delta <span class="sc">-</span> rho) <span class="sc">*</span> c <span class="sc">/</span> <span class="dv">2</span>  <span class="co"># simplified</span></span>
<span id="cb9-536"><a href="#cb9-536"></a>  )</span>
<span id="cb9-537"><a href="#cb9-537"></a></span>
<span id="cb9-538"><a href="#cb9-538"></a><span class="co"># Saddle path (approximate)</span></span>
<span id="cb9-539"><a href="#cb9-539"></a>saddle_path <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb9-540"><a href="#cb9-540"></a>  <span class="at">k =</span> <span class="fu">seq</span>(<span class="fl">0.7</span>, <span class="fl">1.3</span>, <span class="fl">0.01</span>),</span>
<span id="cb9-541"><a href="#cb9-541"></a>  <span class="at">c =</span> c_ss <span class="sc">+</span> <span class="fl">0.8</span> <span class="sc">*</span> (k <span class="sc">-</span> k_ss)  <span class="co"># slope of stable eigenvector</span></span>
<span id="cb9-542"><a href="#cb9-542"></a>)</span>
<span id="cb9-543"><a href="#cb9-543"></a></span>
<span id="cb9-544"><a href="#cb9-544"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb9-545"><a href="#cb9-545"></a>  <span class="co"># Direction field</span></span>
<span id="cb9-546"><a href="#cb9-546"></a>  <span class="fu">geom_segment</span>(<span class="at">data =</span> phase_df <span class="sc">%&gt;%</span> <span class="fu">sample_n</span>(<span class="dv">200</span>),</span>
<span id="cb9-547"><a href="#cb9-547"></a>               <span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> c, <span class="at">xend =</span> k <span class="sc">+</span> dk<span class="sc">*</span><span class="fl">0.05</span>, <span class="at">yend =</span> c <span class="sc">+</span> dc<span class="sc">*</span><span class="fl">0.05</span>),</span>
<span id="cb9-548"><a href="#cb9-548"></a>               <span class="at">arrow =</span> <span class="fu">arrow</span>(<span class="at">length =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>, <span class="st">"cm"</span>)), <span class="at">alpha =</span> <span class="fl">0.3</span>) <span class="sc">+</span></span>
<span id="cb9-549"><a href="#cb9-549"></a>  <span class="co"># Nullclines</span></span>
<span id="cb9-550"><a href="#cb9-550"></a>  <span class="fu">geom_function</span>(<span class="at">fun =</span> c_from_k_nullcline, <span class="at">color =</span> <span class="st">"#3498db"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb9-551"><a href="#cb9-551"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> k_from_c_nullcline, <span class="at">color =</span> <span class="st">"#e74c3c"</span>, <span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb9-552"><a href="#cb9-552"></a>  <span class="co"># Saddle path</span></span>
<span id="cb9-553"><a href="#cb9-553"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> saddle_path, <span class="fu">aes</span>(<span class="at">x =</span> k, <span class="at">y =</span> c),</span>
<span id="cb9-554"><a href="#cb9-554"></a>            <span class="at">color =</span> <span class="st">"#2ecc71"</span>, <span class="at">linewidth =</span> <span class="fl">1.5</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb9-555"><a href="#cb9-555"></a>  <span class="co"># Steady state</span></span>
<span id="cb9-556"><a href="#cb9-556"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> k_ss, <span class="at">y =</span> c_ss), <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">"black"</span>) <span class="sc">+</span></span>
<span id="cb9-557"><a href="#cb9-557"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> k_ss <span class="sc">+</span> <span class="fl">0.05</span>, <span class="at">y =</span> c_ss <span class="sc">+</span> <span class="fl">0.05</span>, <span class="at">label =</span> <span class="st">"Steady State"</span>) <span class="sc">+</span></span>
<span id="cb9-558"><a href="#cb9-558"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.3</span>, <span class="at">y =</span> <span class="fu">c_from_k_nullcline</span>(<span class="fl">1.3</span>) <span class="sc">-</span> <span class="fl">0.05</span>,</span>
<span id="cb9-559"><a href="#cb9-559"></a>           <span class="at">label =</span> <span class="st">"dk = 0"</span>, <span class="at">color =</span> <span class="st">"#3498db"</span>) <span class="sc">+</span></span>
<span id="cb9-560"><a href="#cb9-560"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> k_from_c_nullcline <span class="sc">+</span> <span class="fl">0.05</span>, <span class="at">y =</span> <span class="fl">1.4</span>,</span>
<span id="cb9-561"><a href="#cb9-561"></a>           <span class="at">label =</span> <span class="st">"dc = 0"</span>, <span class="at">color =</span> <span class="st">"#e74c3c"</span>) <span class="sc">+</span></span>
<span id="cb9-562"><a href="#cb9-562"></a>  <span class="fu">annotate</span>(<span class="st">"text"</span>, <span class="at">x =</span> <span class="fl">1.2</span>, <span class="at">y =</span> c_ss <span class="sc">+</span> <span class="fl">0.8</span> <span class="sc">*</span> <span class="fl">0.2</span> <span class="sc">+</span> <span class="fl">0.05</span>,</span>
<span id="cb9-563"><a href="#cb9-563"></a>           <span class="at">label =</span> <span class="st">"Saddle Path"</span>, <span class="at">color =</span> <span class="st">"#2ecc71"</span>) <span class="sc">+</span></span>
<span id="cb9-564"><a href="#cb9-564"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Saddle-Path Stability in DSGE"</span>,</span>
<span id="cb9-565"><a href="#cb9-565"></a>       <span class="at">subtitle =</span> <span class="st">"Jump variable (c) must be on saddle path for convergence"</span>,</span>
<span id="cb9-566"><a href="#cb9-566"></a>       <span class="at">x =</span> <span class="st">"Capital (k)"</span>, <span class="at">y =</span> <span class="st">"Consumption (c)"</span>) <span class="sc">+</span></span>
<span id="cb9-567"><a href="#cb9-567"></a>  <span class="fu">coord_cartesian</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">1.4</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.6</span>, <span class="fl">1.4</span>)) <span class="sc">+</span></span>
<span id="cb9-568"><a href="#cb9-568"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb9-569"><a href="#cb9-569"></a><span class="in">```</span></span>
<span id="cb9-570"><a href="#cb9-570"></a></span>
<span id="cb9-571"><a href="#cb9-571"></a><span class="fu">## Common Causes of BK Violations</span></span>
<span id="cb9-572"><a href="#cb9-572"></a></span>
<span id="cb9-573"><a href="#cb9-573"></a><span class="pp">|</span> Problem <span class="pp">|</span> Symptom <span class="pp">|</span> Common Fix <span class="pp">|</span></span>
<span id="cb9-574"><a href="#cb9-574"></a><span class="pp">|---------|---------|------------|</span></span>
<span id="cb9-575"><a href="#cb9-575"></a><span class="pp">|</span> **Taylor principle violated** <span class="pp">|</span> Too few unstable roots <span class="pp">|</span> Raise $\phi_\pi$ above 1 <span class="pp">|</span></span>
<span id="cb9-576"><a href="#cb9-576"></a><span class="pp">|</span> **Missing expectations** <span class="pp">|</span> Wrong root count <span class="pp">|</span> Check all $\mathbb{E}_t$ terms <span class="pp">|</span></span>
<span id="cb9-577"><a href="#cb9-577"></a><span class="pp">|</span> **Timing error** <span class="pp">|</span> Explosive solutions <span class="pp">|</span> Dynare uses end-of-period capital: use $K(-1)$ <span class="pp">|</span></span>
<span id="cb9-578"><a href="#cb9-578"></a><span class="pp">|</span> **Wrong variable classification** <span class="pp">|</span> Indeterminacy <span class="pp">|</span> Re-check predetermined vs. jump <span class="pp">|</span></span>
<span id="cb9-579"><a href="#cb9-579"></a></span>
<span id="cb9-580"><a href="#cb9-580"></a><span class="fu">## Numerical Solution: QZ Decomposition</span></span>
<span id="cb9-581"><a href="#cb9-581"></a></span>
<span id="cb9-582"><a href="#cb9-582"></a>For larger models, we use the **generalized Schur (QZ) decomposition**:</span>
<span id="cb9-583"><a href="#cb9-583"></a></span>
<span id="cb9-584"><a href="#cb9-584"></a>$$</span>
<span id="cb9-585"><a href="#cb9-585"></a>A = Q \Lambda Z', \quad B = Q \Omega Z'</span>
<span id="cb9-586"><a href="#cb9-586"></a>$$</span>
<span id="cb9-587"><a href="#cb9-587"></a></span>
<span id="cb9-588"><a href="#cb9-588"></a>where $\Lambda/\Omega$ gives generalized eigenvalues. Reorder to put unstable eigenvalues in the bottom block.</span>
<span id="cb9-589"><a href="#cb9-589"></a></span>
<span id="cb9-590"><a href="#cb9-590"></a><span class="in">```r</span></span>
<span id="cb9-591"><a href="#cb9-591"></a><span class="co"># R code sketch for BK solution</span></span>
<span id="cb9-592"><a href="#cb9-592"></a>solve_dsge_bk <span class="ot">&lt;-</span> <span class="cf">function</span>(A, B, n_state) {</span>
<span id="cb9-593"><a href="#cb9-593"></a>  <span class="co"># A * E[y_{t+1}] = B * y_t</span></span>
<span id="cb9-594"><a href="#cb9-594"></a>  <span class="co"># y = [x; z] where x = states, z = jumps</span></span>
<span id="cb9-595"><a href="#cb9-595"></a></span>
<span id="cb9-596"><a href="#cb9-596"></a>  n_total <span class="ot">&lt;-</span> <span class="fu">nrow</span>(A)</span>
<span id="cb9-597"><a href="#cb9-597"></a>  n_jump <span class="ot">&lt;-</span> n_total <span class="sc">-</span> n_state</span>
<span id="cb9-598"><a href="#cb9-598"></a></span>
<span id="cb9-599"><a href="#cb9-599"></a>  <span class="co"># QZ decomposition</span></span>
<span id="cb9-600"><a href="#cb9-600"></a>  qz <span class="ot">&lt;-</span> geigen<span class="sc">::</span><span class="fu">gqz</span>(A, B)  <span class="co"># Generalized Schur</span></span>
<span id="cb9-601"><a href="#cb9-601"></a></span>
<span id="cb9-602"><a href="#cb9-602"></a>  <span class="co"># Eigenvalues</span></span>
<span id="cb9-603"><a href="#cb9-603"></a>  eig <span class="ot">&lt;-</span> qz<span class="sc">$</span>alpha <span class="sc">/</span> qz<span class="sc">$</span>beta</span>
<span id="cb9-604"><a href="#cb9-604"></a>  n_unstable <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">abs</span>(eig) <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb9-605"><a href="#cb9-605"></a></span>
<span id="cb9-606"><a href="#cb9-606"></a>  <span class="co"># Check BK conditions</span></span>
<span id="cb9-607"><a href="#cb9-607"></a>  <span class="cf">if</span> (n_unstable <span class="sc">!=</span> n_jump) {</span>
<span id="cb9-608"><a href="#cb9-608"></a>    <span class="fu">stop</span>(<span class="fu">paste</span>(<span class="st">"BK violation:"</span>, n_unstable, <span class="st">"unstable,"</span>, n_jump, <span class="st">"jump vars"</span>))</span>
<span id="cb9-609"><a href="#cb9-609"></a>  }</span>
<span id="cb9-610"><a href="#cb9-610"></a></span>
<span id="cb9-611"><a href="#cb9-611"></a>  <span class="co"># Extract policy function (from stable block)</span></span>
<span id="cb9-612"><a href="#cb9-612"></a>  <span class="co"># ... (reorder and partition)</span></span>
<span id="cb9-613"><a href="#cb9-613"></a></span>
<span id="cb9-614"><a href="#cb9-614"></a>  <span class="fu">list</span>(<span class="at">G =</span> G_matrix, <span class="at">H =</span> H_matrix, <span class="at">eigenvalues =</span> eig)</span>
<span id="cb9-615"><a href="#cb9-615"></a>}</span>
<span id="cb9-616"><a href="#cb9-616"></a><span class="in">```</span></span>
<span id="cb9-617"><a href="#cb9-617"></a></span>
<span id="cb9-618"><a href="#cb9-618"></a><span class="fu"># Calibration {.unnumbered}</span></span>
<span id="cb9-619"><a href="#cb9-619"></a></span>
<span id="cb9-620"><a href="#cb9-620"></a>Before estimation (Module 11), we **calibrate** parameters using:</span>
<span id="cb9-621"><a href="#cb9-621"></a></span>
<span id="cb9-622"><a href="#cb9-622"></a><span class="ss">1. </span>**Microeconomic evidence** (labor supply elasticity, depreciation rate)</span>
<span id="cb9-623"><a href="#cb9-623"></a><span class="ss">2. </span>**Long-run averages** (capital-output ratio, hours worked)</span>
<span id="cb9-624"><a href="#cb9-624"></a><span class="ss">3. </span>**Steady-state relationships** (Euler equation pins down $\beta$)</span>
<span id="cb9-625"><a href="#cb9-625"></a></span>
<span id="cb9-626"><a href="#cb9-626"></a><span class="fu">## Standard RBC/NK Calibration</span></span>
<span id="cb9-627"><a href="#cb9-627"></a></span>
<span id="cb9-628"><a href="#cb9-628"></a><span class="pp">|</span> Parameter <span class="pp">|</span> Symbol <span class="pp">|</span> Value <span class="pp">|</span> Source <span class="pp">|</span></span>
<span id="cb9-629"><a href="#cb9-629"></a><span class="pp">|-----------|--------|-------|--------|</span></span>
<span id="cb9-630"><a href="#cb9-630"></a><span class="pp">|</span> Discount factor <span class="pp">|</span> $\beta$ <span class="pp">|</span> 0.99 <span class="pp">|</span> Real interest rate ≈ 4% annually <span class="pp">|</span></span>
<span id="cb9-631"><a href="#cb9-631"></a><span class="pp">|</span> Capital share <span class="pp">|</span> $\alpha$ <span class="pp">|</span> 0.33 <span class="pp">|</span> National accounts <span class="pp">|</span></span>
<span id="cb9-632"><a href="#cb9-632"></a><span class="pp">|</span> Depreciation <span class="pp">|</span> $\delta$ <span class="pp">|</span> 0.025 <span class="pp">|</span> 10% annual depreciation <span class="pp">|</span></span>
<span id="cb9-633"><a href="#cb9-633"></a><span class="pp">|</span> Risk aversion <span class="pp">|</span> $\sigma$ <span class="pp">|</span> 1-2 <span class="pp">|</span> Micro studies <span class="pp">|</span></span>
<span id="cb9-634"><a href="#cb9-634"></a><span class="pp">|</span> Frisch elasticity <span class="pp">|</span> $1/\phi$ <span class="pp">|</span> 0.5-2 <span class="pp">|</span> Labor supply literature <span class="pp">|</span></span>
<span id="cb9-635"><a href="#cb9-635"></a><span class="pp">|</span> Calvo parameter <span class="pp">|</span> $\theta$ <span class="pp">|</span> 0.75 <span class="pp">|</span> Prices adjust every 4 quarters <span class="pp">|</span></span>
<span id="cb9-636"><a href="#cb9-636"></a><span class="pp">|</span> Inflation weight <span class="pp">|</span> $\phi_\pi$ <span class="pp">|</span> 1.5 <span class="pp">|</span> Taylor (1993) <span class="pp">|</span></span>
<span id="cb9-637"><a href="#cb9-637"></a><span class="pp">|</span> Output weight <span class="pp">|</span> $\phi_y$ <span class="pp">|</span> 0.125 <span class="pp">|</span> Taylor (1993), quarterly <span class="pp">|</span></span>
<span id="cb9-638"><a href="#cb9-638"></a></span>
<span id="cb9-639"><a href="#cb9-639"></a><span class="fu">## Matching Moments</span></span>
<span id="cb9-640"><a href="#cb9-640"></a></span>
<span id="cb9-641"><a href="#cb9-641"></a>**Target**: Model-implied moments ≈ Data moments</span>
<span id="cb9-642"><a href="#cb9-642"></a></span>
<span id="cb9-643"><a href="#cb9-643"></a><span class="pp">|</span> Moment <span class="pp">|</span> Data (US) <span class="pp">|</span> Typical RBC <span class="pp">|</span></span>
<span id="cb9-644"><a href="#cb9-644"></a><span class="pp">|--------|-----------|-------------|</span></span>
<span id="cb9-645"><a href="#cb9-645"></a><span class="pp">|</span> std(Y) <span class="pp">|</span> 1.5-2% <span class="pp">|</span> Match by calibrating $\sigma_A$ <span class="pp">|</span></span>
<span id="cb9-646"><a href="#cb9-646"></a><span class="pp">|</span> std(C)/std(Y) <span class="pp">|</span> 0.5-0.7 <span class="pp">|</span> Endogenous <span class="pp">|</span></span>
<span id="cb9-647"><a href="#cb9-647"></a><span class="pp">|</span> std(I)/std(Y) <span class="pp">|</span> 2.5-3.5 <span class="pp">|</span> Endogenous <span class="pp">|</span></span>
<span id="cb9-648"><a href="#cb9-648"></a><span class="pp">|</span> corr(C, Y) <span class="pp">|</span> 0.8-0.9 <span class="pp">|</span> Endogenous <span class="pp">|</span></span>
<span id="cb9-649"><a href="#cb9-649"></a><span class="pp">|</span> corr(N, Y) <span class="pp">|</span> 0.8-0.9 <span class="pp">|</span> Endogenous <span class="pp">|</span></span>
<span id="cb9-650"><a href="#cb9-650"></a></span>
<span id="cb9-653"><a href="#cb9-653"></a><span class="in">```{r}</span></span>
<span id="cb9-654"><a href="#cb9-654"></a><span class="co">#| label: calibration-demo</span></span>
<span id="cb9-655"><a href="#cb9-655"></a><span class="co">#| fig-cap: "Calibration: matching business cycle moments"</span></span>
<span id="cb9-656"><a href="#cb9-656"></a></span>
<span id="cb9-657"><a href="#cb9-657"></a><span class="co"># Simulate RBC model and compute moments</span></span>
<span id="cb9-658"><a href="#cb9-658"></a><span class="co"># Simplified AR(1) approximation</span></span>
<span id="cb9-659"><a href="#cb9-659"></a></span>
<span id="cb9-660"><a href="#cb9-660"></a><span class="co"># Parameters</span></span>
<span id="cb9-661"><a href="#cb9-661"></a>rho_a <span class="ot">&lt;-</span> <span class="fl">0.95</span></span>
<span id="cb9-662"><a href="#cb9-662"></a>sigma_a <span class="ot">&lt;-</span> <span class="fl">0.007</span></span>
<span id="cb9-663"><a href="#cb9-663"></a>T_sim <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb9-664"><a href="#cb9-664"></a></span>
<span id="cb9-665"><a href="#cb9-665"></a><span class="co"># Technology shock</span></span>
<span id="cb9-666"><a href="#cb9-666"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb9-667"><a href="#cb9-667"></a>log_a <span class="ot">&lt;-</span> <span class="fu">numeric</span>(T_sim)</span>
<span id="cb9-668"><a href="#cb9-668"></a>log_a[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-669"><a href="#cb9-669"></a><span class="cf">for</span> (t <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>T_sim) {</span>
<span id="cb9-670"><a href="#cb9-670"></a>  log_a[t] <span class="ot">&lt;-</span> rho_a <span class="sc">*</span> log_a[t<span class="dv">-1</span>] <span class="sc">+</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, sigma_a)</span>
<span id="cb9-671"><a href="#cb9-671"></a>}</span>
<span id="cb9-672"><a href="#cb9-672"></a></span>
<span id="cb9-673"><a href="#cb9-673"></a><span class="co"># Simplified responses (from RBC solution)</span></span>
<span id="cb9-674"><a href="#cb9-674"></a><span class="co"># Output: y_hat ≈ (1 + alpha/(1-alpha)) * a_hat</span></span>
<span id="cb9-675"><a href="#cb9-675"></a><span class="co"># Consumption: c_hat ≈ 0.7 * y_hat (consumption smoother than output)</span></span>
<span id="cb9-676"><a href="#cb9-676"></a><span class="co"># Investment: i_hat ≈ 3 * y_hat (investment more volatile)</span></span>
<span id="cb9-677"><a href="#cb9-677"></a><span class="co"># Hours: n_hat ≈ 0.5 * y_hat</span></span>
<span id="cb9-678"><a href="#cb9-678"></a></span>
<span id="cb9-679"><a href="#cb9-679"></a>y_hat <span class="ot">&lt;-</span> <span class="fl">1.5</span> <span class="sc">*</span> log_a</span>
<span id="cb9-680"><a href="#cb9-680"></a>c_hat <span class="ot">&lt;-</span> <span class="fl">0.7</span> <span class="sc">*</span> y_hat <span class="sc">+</span> <span class="fu">rnorm</span>(T_sim, <span class="dv">0</span>, <span class="fl">0.002</span>)</span>
<span id="cb9-681"><a href="#cb9-681"></a>i_hat <span class="ot">&lt;-</span> <span class="fl">3.0</span> <span class="sc">*</span> y_hat <span class="sc">+</span> <span class="fu">rnorm</span>(T_sim, <span class="dv">0</span>, <span class="fl">0.005</span>)</span>
<span id="cb9-682"><a href="#cb9-682"></a>n_hat <span class="ot">&lt;-</span> <span class="fl">0.5</span> <span class="sc">*</span> y_hat <span class="sc">+</span> <span class="fu">rnorm</span>(T_sim, <span class="dv">0</span>, <span class="fl">0.003</span>)</span>
<span id="cb9-683"><a href="#cb9-683"></a></span>
<span id="cb9-684"><a href="#cb9-684"></a><span class="co"># Compute moments</span></span>
<span id="cb9-685"><a href="#cb9-685"></a>moments_model <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb9-686"><a href="#cb9-686"></a>  <span class="at">Variable =</span> <span class="fu">c</span>(<span class="st">"Output"</span>, <span class="st">"Consumption"</span>, <span class="st">"Investment"</span>, <span class="st">"Hours"</span>),</span>
<span id="cb9-687"><a href="#cb9-687"></a>  <span class="st">`</span><span class="at">Std Dev (%)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fu">sd</span>(y_hat), <span class="fu">sd</span>(c_hat), <span class="fu">sd</span>(i_hat), <span class="fu">sd</span>(n_hat)) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb9-688"><a href="#cb9-688"></a>  <span class="st">`</span><span class="at">Rel to Y</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">sd</span>(c_hat)<span class="sc">/</span><span class="fu">sd</span>(y_hat), <span class="fu">sd</span>(i_hat)<span class="sc">/</span><span class="fu">sd</span>(y_hat), <span class="fu">sd</span>(n_hat)<span class="sc">/</span><span class="fu">sd</span>(y_hat)),</span>
<span id="cb9-689"><a href="#cb9-689"></a>  <span class="st">`</span><span class="at">Corr with Y</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fu">cor</span>(c_hat, y_hat), <span class="fu">cor</span>(i_hat, y_hat), <span class="fu">cor</span>(n_hat, y_hat))</span>
<span id="cb9-690"><a href="#cb9-690"></a>)</span>
<span id="cb9-691"><a href="#cb9-691"></a></span>
<span id="cb9-692"><a href="#cb9-692"></a><span class="co"># Add data targets</span></span>
<span id="cb9-693"><a href="#cb9-693"></a>moments_data <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb9-694"><a href="#cb9-694"></a>  <span class="at">Variable =</span> <span class="fu">c</span>(<span class="st">"Output"</span>, <span class="st">"Consumption"</span>, <span class="st">"Investment"</span>, <span class="st">"Hours"</span>),</span>
<span id="cb9-695"><a href="#cb9-695"></a>  <span class="st">`</span><span class="at">Std Dev (%)</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">1.8</span>, <span class="fl">1.0</span>, <span class="fl">5.0</span>, <span class="fl">1.5</span>),</span>
<span id="cb9-696"><a href="#cb9-696"></a>  <span class="st">`</span><span class="at">Rel to Y</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.55</span>, <span class="fl">2.8</span>, <span class="fl">0.83</span>),</span>
<span id="cb9-697"><a href="#cb9-697"></a>  <span class="st">`</span><span class="at">Corr with Y</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">0.85</span>, <span class="fl">0.90</span>, <span class="fl">0.85</span>)</span>
<span id="cb9-698"><a href="#cb9-698"></a>)</span>
<span id="cb9-699"><a href="#cb9-699"></a></span>
<span id="cb9-700"><a href="#cb9-700"></a><span class="co"># Display</span></span>
<span id="cb9-701"><a href="#cb9-701"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(</span>
<span id="cb9-702"><a href="#cb9-702"></a>  <span class="fu">bind_rows</span>(</span>
<span id="cb9-703"><a href="#cb9-703"></a>    moments_model <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Source =</span> <span class="st">"Model"</span>),</span>
<span id="cb9-704"><a href="#cb9-704"></a>    moments_data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">Source =</span> <span class="st">"Data"</span>)</span>
<span id="cb9-705"><a href="#cb9-705"></a>  ) <span class="sc">%&gt;%</span></span>
<span id="cb9-706"><a href="#cb9-706"></a>    <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> Source, <span class="at">values_from =</span> <span class="fu">c</span>(<span class="st">`</span><span class="at">Std Dev (%)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Rel to Y</span><span class="st">`</span>, <span class="st">`</span><span class="at">Corr with Y</span><span class="st">`</span>)),</span>
<span id="cb9-707"><a href="#cb9-707"></a>  <span class="at">caption =</span> <span class="st">"Business Cycle Moments: Model vs. Data"</span>,</span>
<span id="cb9-708"><a href="#cb9-708"></a>  <span class="at">digits =</span> <span class="dv">2</span></span>
<span id="cb9-709"><a href="#cb9-709"></a>)</span>
<span id="cb9-710"><a href="#cb9-710"></a><span class="in">```</span></span>
<span id="cb9-711"><a href="#cb9-711"></a></span>
<span id="cb9-712"><a href="#cb9-712"></a><span class="fu">## Steady-State Relationships</span></span>
<span id="cb9-713"><a href="#cb9-713"></a></span>
<span id="cb9-714"><a href="#cb9-714"></a>Many parameters are pinned down by steady-state conditions:</span>
<span id="cb9-715"><a href="#cb9-715"></a></span>
<span id="cb9-716"><a href="#cb9-716"></a>**From Euler equation**:</span>
<span id="cb9-717"><a href="#cb9-717"></a>$$</span>
<span id="cb9-718"><a href="#cb9-718"></a>\bar{R} = \frac{1}{\beta} \implies \beta = \frac{1}{1 + r^*}</span>
<span id="cb9-719"><a href="#cb9-719"></a>$$</span>
<span id="cb9-720"><a href="#cb9-720"></a>With $r^* = 4\%$ annually → $\beta = 1/1.01 \approx 0.99$ quarterly.</span>
<span id="cb9-721"><a href="#cb9-721"></a></span>
<span id="cb9-722"><a href="#cb9-722"></a>**From capital demand**:</span>
<span id="cb9-723"><a href="#cb9-723"></a>$$</span>
<span id="cb9-724"><a href="#cb9-724"></a>\bar{R}^K = \alpha \frac{\bar{Y}}{\bar{K}} = \frac{1}{\beta} - (1-\delta)</span>
<span id="cb9-725"><a href="#cb9-725"></a>$$</span>
<span id="cb9-726"><a href="#cb9-726"></a>Given $\beta$, $\delta$, and capital-output ratio, backs out $\alpha$.</span>
<span id="cb9-727"><a href="#cb9-727"></a></span>
<span id="cb9-728"><a href="#cb9-728"></a>**From labor supply**:</span>
<span id="cb9-729"><a href="#cb9-729"></a>$$</span>
<span id="cb9-730"><a href="#cb9-730"></a>\chi \bar{N}^\phi \bar{C} = \bar{W} = (1-\alpha)\frac{\bar{Y}}{\bar{N}}</span>
<span id="cb9-731"><a href="#cb9-731"></a>$$</span>
<span id="cb9-732"><a href="#cb9-732"></a>Given target $\bar{N} = 1/3$ (8 hours/day), backs out $\chi$.</span>
<span id="cb9-733"><a href="#cb9-733"></a></span>
<span id="cb9-734"><a href="#cb9-734"></a><span class="fu"># Dynare Basics {.unnumbered}</span></span>
<span id="cb9-735"><a href="#cb9-735"></a></span>
<span id="cb9-736"><a href="#cb9-736"></a>**Dynare** is the standard software for solving and estimating DSGE models. Here's a minimal example.</span>
<span id="cb9-737"><a href="#cb9-737"></a></span>
<span id="cb9-738"><a href="#cb9-738"></a><span class="fu">## A Simple RBC Model in Dynare</span></span>
<span id="cb9-739"><a href="#cb9-739"></a></span>
<span id="cb9-740"><a href="#cb9-740"></a><span class="in">```matlab</span></span>
<span id="cb9-741"><a href="#cb9-741"></a><span class="co">%% RBC Model - rbc_simple.mod</span></span>
<span id="cb9-742"><a href="#cb9-742"></a><span class="co">%% Preamble</span></span>
<span id="cb9-743"><a href="#cb9-743"></a><span class="va">var</span> <span class="va">y</span> <span class="va">c</span> <span class="va">k</span> <span class="va">n</span> <span class="va">w</span> <span class="va">r</span> <span class="va">a</span><span class="op">;</span></span>
<span id="cb9-744"><a href="#cb9-744"></a><span class="va">varexo</span> <span class="va">eps_a</span><span class="op">;</span></span>
<span id="cb9-745"><a href="#cb9-745"></a><span class="va">parameters</span> <span class="va">BETA</span> <span class="va">ALPHA</span> <span class="va">DELTA</span> <span class="va">RHO_A</span> <span class="va">SIGMA_A</span> <span class="va">CHI</span> <span class="va">PHI</span><span class="op">;</span></span>
<span id="cb9-746"><a href="#cb9-746"></a></span>
<span id="cb9-747"><a href="#cb9-747"></a><span class="co">%% Calibration</span></span>
<span id="cb9-748"><a href="#cb9-748"></a><span class="va">BETA</span> <span class="op">=</span> <span class="fl">0.99</span><span class="op">;</span></span>
<span id="cb9-749"><a href="#cb9-749"></a><span class="va">ALPHA</span> <span class="op">=</span> <span class="fl">0.33</span><span class="op">;</span></span>
<span id="cb9-750"><a href="#cb9-750"></a><span class="va">DELTA</span> <span class="op">=</span> <span class="fl">0.025</span><span class="op">;</span></span>
<span id="cb9-751"><a href="#cb9-751"></a><span class="va">RHO_A</span> <span class="op">=</span> <span class="fl">0.95</span><span class="op">;</span></span>
<span id="cb9-752"><a href="#cb9-752"></a><span class="va">SIGMA_A</span> <span class="op">=</span> <span class="fl">0.007</span><span class="op">;</span></span>
<span id="cb9-753"><a href="#cb9-753"></a><span class="va">CHI</span> <span class="op">=</span> <span class="fl">1</span><span class="op">;</span>       <span class="co">% labor disutility</span></span>
<span id="cb9-754"><a href="#cb9-754"></a><span class="va">PHI</span> <span class="op">=</span> <span class="fl">1</span><span class="op">;</span>       <span class="co">% inverse Frisch elasticity</span></span>
<span id="cb9-755"><a href="#cb9-755"></a></span>
<span id="cb9-756"><a href="#cb9-756"></a><span class="co">%% Model equations</span></span>
<span id="cb9-757"><a href="#cb9-757"></a><span class="va">model</span><span class="op">;</span></span>
<span id="cb9-758"><a href="#cb9-758"></a>  <span class="co">% Euler equation</span></span>
<span id="cb9-759"><a href="#cb9-759"></a>  <span class="fl">1</span><span class="op">/</span><span class="va">c</span> <span class="op">=</span> <span class="va">BETA</span> <span class="op">*</span> (<span class="fl">1</span><span class="op">/</span><span class="va">c</span>(<span class="op">+</span><span class="fl">1</span>)) <span class="op">*</span> (<span class="va">r</span>(<span class="op">+</span><span class="fl">1</span>) <span class="op">+</span> <span class="fl">1</span> <span class="op">-</span> <span class="va">DELTA</span>)<span class="op">;</span></span>
<span id="cb9-760"><a href="#cb9-760"></a></span>
<span id="cb9-761"><a href="#cb9-761"></a>  <span class="co">% Labor supply</span></span>
<span id="cb9-762"><a href="#cb9-762"></a>  <span class="va">CHI</span> <span class="op">*</span> <span class="va">n</span><span class="op">^</span><span class="va">PHI</span> <span class="op">*</span> <span class="va">c</span> <span class="op">=</span> <span class="va">w</span><span class="op">;</span></span>
<span id="cb9-763"><a href="#cb9-763"></a></span>
<span id="cb9-764"><a href="#cb9-764"></a>  <span class="co">% Production function</span></span>
<span id="cb9-765"><a href="#cb9-765"></a>  <span class="va">y</span> <span class="op">=</span> <span class="va">a</span> <span class="op">*</span> <span class="va">k</span>(<span class="op">-</span><span class="fl">1</span>)<span class="op">^</span><span class="va">ALPHA</span> <span class="op">*</span> <span class="va">n</span><span class="op">^</span>(<span class="fl">1</span><span class="op">-</span><span class="va">ALPHA</span>)<span class="op">;</span></span>
<span id="cb9-766"><a href="#cb9-766"></a></span>
<span id="cb9-767"><a href="#cb9-767"></a>  <span class="co">% Factor prices</span></span>
<span id="cb9-768"><a href="#cb9-768"></a>  <span class="va">w</span> <span class="op">=</span> (<span class="fl">1</span><span class="op">-</span><span class="va">ALPHA</span>) <span class="op">*</span> <span class="va">y</span> <span class="op">/</span> <span class="va">n</span><span class="op">;</span></span>
<span id="cb9-769"><a href="#cb9-769"></a>  <span class="va">r</span> <span class="op">=</span> <span class="va">ALPHA</span> <span class="op">*</span> <span class="va">y</span> <span class="op">/</span> <span class="va">k</span>(<span class="op">-</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb9-770"><a href="#cb9-770"></a></span>
<span id="cb9-771"><a href="#cb9-771"></a>  <span class="co">% Resource constraint</span></span>
<span id="cb9-772"><a href="#cb9-772"></a>  <span class="va">y</span> <span class="op">=</span> <span class="va">c</span> <span class="op">+</span> <span class="va">k</span> <span class="op">-</span> (<span class="fl">1</span><span class="op">-</span><span class="va">DELTA</span>)<span class="op">*</span><span class="va">k</span>(<span class="op">-</span><span class="fl">1</span>)<span class="op">;</span></span>
<span id="cb9-773"><a href="#cb9-773"></a></span>
<span id="cb9-774"><a href="#cb9-774"></a>  <span class="co">% Technology shock</span></span>
<span id="cb9-775"><a href="#cb9-775"></a>  <span class="va">log</span>(<span class="va">a</span>) <span class="op">=</span> <span class="va">RHO_A</span> <span class="op">*</span> <span class="va">log</span>(<span class="va">a</span>(<span class="op">-</span><span class="fl">1</span>)) <span class="op">+</span> <span class="va">eps_a</span><span class="op">;</span></span>
<span id="cb9-776"><a href="#cb9-776"></a><span class="kw">end</span><span class="op">;</span></span>
<span id="cb9-777"><a href="#cb9-777"></a></span>
<span id="cb9-778"><a href="#cb9-778"></a><span class="co">%% Steady state</span></span>
<span id="cb9-779"><a href="#cb9-779"></a><span class="va">initval</span><span class="op">;</span></span>
<span id="cb9-780"><a href="#cb9-780"></a>  <span class="va">a</span> <span class="op">=</span> <span class="fl">1</span><span class="op">;</span></span>
<span id="cb9-781"><a href="#cb9-781"></a>  <span class="va">r</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">BETA</span> <span class="op">-</span> <span class="fl">1</span> <span class="op">+</span> <span class="va">DELTA</span><span class="op">;</span></span>
<span id="cb9-782"><a href="#cb9-782"></a>  <span class="va">k</span> <span class="op">=</span> (<span class="va">ALPHA</span><span class="op">/</span><span class="va">r</span>)<span class="op">^</span>(<span class="fl">1</span><span class="op">/</span>(<span class="fl">1</span><span class="op">-</span><span class="va">ALPHA</span>)) <span class="op">*</span> <span class="fl">0.33</span><span class="op">;</span></span>
<span id="cb9-783"><a href="#cb9-783"></a>  <span class="va">n</span> <span class="op">=</span> <span class="fl">0.33</span><span class="op">;</span></span>
<span id="cb9-784"><a href="#cb9-784"></a>  <span class="va">y</span> <span class="op">=</span> <span class="va">a</span> <span class="op">*</span> <span class="va">k</span><span class="op">^</span><span class="va">ALPHA</span> <span class="op">*</span> <span class="va">n</span><span class="op">^</span>(<span class="fl">1</span><span class="op">-</span><span class="va">ALPHA</span>)<span class="op">;</span></span>
<span id="cb9-785"><a href="#cb9-785"></a>  <span class="va">c</span> <span class="op">=</span> <span class="va">y</span> <span class="op">-</span> <span class="va">DELTA</span><span class="op">*</span><span class="va">k</span><span class="op">;</span></span>
<span id="cb9-786"><a href="#cb9-786"></a>  <span class="va">w</span> <span class="op">=</span> (<span class="fl">1</span><span class="op">-</span><span class="va">ALPHA</span>) <span class="op">*</span> <span class="va">y</span> <span class="op">/</span> <span class="va">n</span><span class="op">;</span></span>
<span id="cb9-787"><a href="#cb9-787"></a><span class="kw">end</span><span class="op">;</span></span>
<span id="cb9-788"><a href="#cb9-788"></a></span>
<span id="cb9-789"><a href="#cb9-789"></a><span class="va">steady</span><span class="op">;</span></span>
<span id="cb9-790"><a href="#cb9-790"></a><span class="va">check</span><span class="op">;</span></span>
<span id="cb9-791"><a href="#cb9-791"></a></span>
<span id="cb9-792"><a href="#cb9-792"></a><span class="co">%% Shocks</span></span>
<span id="cb9-793"><a href="#cb9-793"></a><span class="va">shocks</span><span class="op">;</span></span>
<span id="cb9-794"><a href="#cb9-794"></a>  <span class="va">var</span> <span class="va">eps_a</span><span class="op">;</span> <span class="va">stderr</span> <span class="va">SIGMA_A</span><span class="op">;</span></span>
<span id="cb9-795"><a href="#cb9-795"></a><span class="kw">end</span><span class="op">;</span></span>
<span id="cb9-796"><a href="#cb9-796"></a></span>
<span id="cb9-797"><a href="#cb9-797"></a><span class="co">%% Simulation</span></span>
<span id="cb9-798"><a href="#cb9-798"></a><span class="va">stoch_simul</span>(<span class="va">order</span><span class="op">=</span><span class="fl">1</span><span class="op">,</span> <span class="va">irf</span><span class="op">=</span><span class="fl">40</span><span class="op">,</span> <span class="va">periods</span><span class="op">=</span><span class="fl">200</span>)<span class="op">;</span></span>
<span id="cb9-799"><a href="#cb9-799"></a>```</span>
<span id="cb9-800"><a href="#cb9-800"></a></span>
<span id="cb9-801"><a href="#cb9-801"></a>## <span class="va">Key</span> <span class="va">Dynare</span> <span class="va">Commands</span></span>
<span id="cb9-802"><a href="#cb9-802"></a></span>
<span id="cb9-803"><a href="#cb9-803"></a><span class="op">|</span> <span class="va">Command</span> <span class="op">|</span> <span class="va">Purpose</span> <span class="op">|</span></span>
<span id="cb9-804"><a href="#cb9-804"></a><span class="op">|---------|---------|</span></span>
<span id="cb9-805"><a href="#cb9-805"></a><span class="op">|</span> `<span class="va">steady</span>` <span class="op">|</span> <span class="va">Compute</span> <span class="va">deterministic</span> <span class="va">steady</span> <span class="va">state</span> <span class="op">|</span></span>
<span id="cb9-806"><a href="#cb9-806"></a><span class="op">|</span> `<span class="va">check</span>` <span class="op">|</span> <span class="va">Verify</span> <span class="va">Blanchard</span><span class="op">-</span><span class="va">Kahn</span> <span class="va">conditions</span> <span class="op">|</span></span>
<span id="cb9-807"><a href="#cb9-807"></a><span class="op">|</span> `<span class="va">stoch_simul</span>(<span class="va">order</span><span class="op">=</span><span class="fl">1</span>)` <span class="op">|</span> <span class="va">First</span><span class="op">-</span><span class="va">order</span> <span class="va">perturbation</span> <span class="va">solution</span> <span class="op">|</span></span>
<span id="cb9-808"><a href="#cb9-808"></a><span class="op">|</span> `<span class="va">stoch_simul</span>(<span class="va">irf</span><span class="op">=</span><span class="fl">40</span>)` <span class="op">|</span> <span class="va">Generate</span> <span class="va">IRFs</span> <span class="kw">for</span> <span class="fl">40</span> <span class="va">periods</span> <span class="op">|</span></span>
<span id="cb9-809"><a href="#cb9-809"></a><span class="op">|</span> `<span class="va">estimation</span>(<span class="op">...</span>)` <span class="op">|</span> <span class="va">Bayesian</span> <span class="va">estimation</span> (<span class="va">Module</span> <span class="fl">11</span>) <span class="op">|</span></span>
<span id="cb9-810"><a href="#cb9-810"></a><span class="op">|</span> `<span class="va">model_diagnostics</span>` <span class="op">|</span> <span class="va">Check</span> <span class="va">model</span> <span class="va">specification</span> <span class="op">|</span></span>
<span id="cb9-811"><a href="#cb9-811"></a></span>
<span id="cb9-812"><a href="#cb9-812"></a>## <span class="va">Important</span> <span class="va">Timing</span> <span class="va">Convention</span></span>
<span id="cb9-813"><a href="#cb9-813"></a></span>
<span id="cb9-814"><a href="#cb9-814"></a><span class="op">:::</span> {.<span class="va">callout</span><span class="op">-</span><span class="va">warning</span>}</span>
<span id="cb9-815"><a href="#cb9-815"></a>## <span class="va">Dynare</span> <span class="va">Timing</span></span>
<span id="cb9-816"><a href="#cb9-816"></a></span>
<span id="cb9-817"><a href="#cb9-817"></a><span class="va">Dynare</span> <span class="va">uses</span> <span class="op">**</span><span class="kw">end</span><span class="op">-</span><span class="va">of</span><span class="op">-</span><span class="va">period</span><span class="op">**</span> <span class="va">capital</span><span class="op">:</span></span>
<span id="cb9-818"><a href="#cb9-818"></a><span class="op">-</span> `<span class="va">k</span>` <span class="va">without</span> <span class="va">subscript</span> <span class="op">=</span> $<span class="va">K_t</span>$ (<span class="kw">end</span> <span class="va">of</span> <span class="va">period</span> $<span class="va">t</span>$)</span>
<span id="cb9-819"><a href="#cb9-819"></a><span class="op">-</span> `<span class="va">k</span>(<span class="op">-</span><span class="fl">1</span>)` <span class="op">=</span> $<span class="va">K_</span>{<span class="va">t</span><span class="op">-</span><span class="fl">1</span>}$ (<span class="va">beginning</span> <span class="va">of</span> <span class="va">period</span> $<span class="va">t</span>$ <span class="op">=</span> <span class="kw">end</span> <span class="va">of</span> $<span class="va">t</span><span class="op">-</span><span class="fl">1</span>$)</span>
<span id="cb9-820"><a href="#cb9-820"></a></span>
<span id="cb9-821"><a href="#cb9-821"></a><span class="va">So</span> <span class="va">the</span> <span class="va">production</span> <span class="kw">function</span> <span class="va">uses</span> `<span class="va">k</span>(<span class="op">-</span><span class="fl">1</span>)`<span class="op">:</span></span>
<span id="cb9-822"><a href="#cb9-822"></a>```</span>
<span id="cb9-823"><a href="#cb9-823"></a><span class="va">y</span> <span class="op">=</span> <span class="va">a</span> <span class="op">*</span> <span class="va">k</span>(<span class="op">-</span><span class="fl">1</span>)<span class="op">^</span><span class="va">ALPHA</span> <span class="op">*</span> <span class="va">n</span><span class="op">^</span>(<span class="fl">1</span><span class="op">-</span><span class="va">ALPHA</span>)<span class="op">;</span></span>
<span id="cb9-824"><a href="#cb9-824"></a>```</span>
<span id="cb9-825"><a href="#cb9-825"></a><span class="op">:::</span></span>
<span id="cb9-826"><a href="#cb9-826"></a></span>
<span id="cb9-827"><a href="#cb9-827"></a># <span class="va">Summary</span> {.<span class="va">unnumbered</span>}</span>
<span id="cb9-828"><a href="#cb9-828"></a></span>
<span id="cb9-829"><a href="#cb9-829"></a><span class="op">|</span> <span class="va">Concept</span> <span class="op">|</span> <span class="va">Key</span> <span class="va">Insight</span> <span class="op">|</span></span>
<span id="cb9-830"><a href="#cb9-830"></a><span class="op">|---------|-------------|</span></span>
<span id="cb9-831"><a href="#cb9-831"></a><span class="op">|</span> <span class="op">**</span><span class="va">DSGE</span> <span class="va">structure</span><span class="op">**</span> <span class="op">|</span> <span class="va">Microfounded</span> <span class="va">optimization</span> → <span class="va">aggregate</span> <span class="va">equilibrium</span> <span class="op">|</span></span>
<span id="cb9-832"><a href="#cb9-832"></a><span class="op">|</span> <span class="op">**</span><span class="va">Households</span><span class="op">**</span> <span class="op">|</span> <span class="va">Euler</span> <span class="va">equation</span> <span class="va">governs</span> <span class="va">intertemporal</span> <span class="va">choice</span> <span class="op">|</span></span>
<span id="cb9-833"><a href="#cb9-833"></a><span class="op">|</span> <span class="op">**</span><span class="va">Firms</span> (<span class="va">NK</span>)<span class="op">**</span> <span class="op">|</span> <span class="va">Calvo</span> <span class="va">pricing</span> → <span class="va">forward</span><span class="op">-</span><span class="va">looking</span> <span class="va">Phillips</span> <span class="va">curve</span> <span class="op">|</span></span>
<span id="cb9-834"><a href="#cb9-834"></a><span class="op">|</span> <span class="op">**</span><span class="va">Monetary</span> <span class="va">policy</span><span class="op">**</span> <span class="op">|</span> <span class="va">Taylor</span> <span class="va">rule</span> <span class="va">with</span> $<span class="op">\</span><span class="va">phi_</span><span class="op">\</span><span class="va">pi</span> <span class="op">&gt;</span> <span class="fl">1</span>$ <span class="kw">for</span> <span class="va">stability</span> <span class="op">|</span></span>
<span id="cb9-835"><a href="#cb9-835"></a><span class="op">|</span> <span class="op">**</span><span class="va">Log</span><span class="op">-</span><span class="va">linearization</span><span class="op">**</span> <span class="op">|</span> <span class="va">Approximate</span> <span class="va">around</span> <span class="va">steady</span> <span class="va">state</span> <span class="kw">for</span> <span class="va">solution</span> <span class="op">|</span></span>
<span id="cb9-836"><a href="#cb9-836"></a><span class="op">|</span> <span class="op">**</span><span class="va">Blanchard</span><span class="op">-</span><span class="va">Kahn</span><span class="op">**</span> <span class="op">|</span> <span class="va">Saddle</span><span class="op">-</span><span class="va">path</span> <span class="va">stability</span> <span class="va">requires</span> <span class="va">correct</span> <span class="va">eigenvalue</span> <span class="va">count</span> <span class="op">|</span></span>
<span id="cb9-837"><a href="#cb9-837"></a><span class="op">|</span> <span class="op">**</span><span class="va">Calibration</span><span class="op">**</span> <span class="op">|</span> <span class="va">Match</span> <span class="va">parameters</span> <span class="va">to</span> <span class="va">micro</span> <span class="va">evidence</span> <span class="va">and</span> <span class="va">steady</span><span class="op">-</span><span class="va">state</span> <span class="va">targets</span> <span class="op">|</span></span>
<span id="cb9-838"><a href="#cb9-838"></a></span>
<span id="cb9-839"><a href="#cb9-839"></a><span class="op">:::</span> {.<span class="va">callout</span><span class="op">-</span><span class="va">tip</span>}</span>
<span id="cb9-840"><a href="#cb9-840"></a>## <span class="va">Next</span> <span class="va">Steps</span></span>
<span id="cb9-841"><a href="#cb9-841"></a></span>
<span id="cb9-842"><a href="#cb9-842"></a><span class="va">Module</span> <span class="fl">11</span> <span class="va">covers</span> <span class="op">**</span><span class="va">DSGE</span> <span class="va">estimation</span><span class="op">**:</span></span>
<span id="cb9-843"><a href="#cb9-843"></a><span class="op">-</span> <span class="va">Bayesian</span> <span class="kw">methods</span> <span class="va">with</span> <span class="va">Metropolis</span><span class="op">-</span><span class="va">Hastings</span></span>
<span id="cb9-844"><a href="#cb9-844"></a><span class="op">-</span> <span class="va">The</span> <span class="va">Kalman</span> <span class="va">filter</span> <span class="kw">for</span> <span class="va">likelihood</span> <span class="va">evaluation</span></span>
<span id="cb9-845"><a href="#cb9-845"></a><span class="op">-</span> <span class="va">Model</span> <span class="va">comparison</span> <span class="va">via</span> <span class="va">marginal</span> <span class="va">likelihood</span></span>
<span id="cb9-846"><a href="#cb9-846"></a><span class="op">-</span> <span class="va">Dynare</span><span class="op">'</span><span class="va">s</span> `<span class="va">estimation</span>` <span class="va">command</span></span>
<span id="cb9-847"><a href="#cb9-847"></a><span class="op">:::</span></span>
<span id="cb9-848"><a href="#cb9-848"></a></span>
<span id="cb9-849"><a href="#cb9-849"></a># <span class="va">Key</span> <span class="va">References</span> {.<span class="va">unnumbered</span>}</span>
<span id="cb9-850"><a href="#cb9-850"></a></span>
<span id="cb9-851"><a href="#cb9-851"></a>## <span class="va">Foundational</span></span>
<span id="cb9-852"><a href="#cb9-852"></a><span class="op">-</span> <span class="op">**</span><span class="va">Kydland</span> <span class="op">&amp;</span> <span class="va">Prescott</span> (<span class="fl">1982</span>)<span class="op">**</span> <span class="st">"Time to Build and Aggregate Fluctuations"</span> <span class="va">Econometrica</span> — <span class="va">RBC</span> <span class="va">origins</span></span>
<span id="cb9-853"><a href="#cb9-853"></a><span class="op">-</span> <span class="op">**</span><span class="va">Blanchard</span> <span class="op">&amp;</span> <span class="va">Kahn</span> (<span class="fl">1980</span>)<span class="op">**</span> <span class="st">"The Solution of Linear Difference Models"</span> <span class="va">Econometrica</span> — <span class="va">BK</span> <span class="va">conditions</span></span>
<span id="cb9-854"><a href="#cb9-854"></a><span class="op">-</span> <span class="op">**</span><span class="va">Galí</span> (<span class="fl">2015</span>)<span class="op">**</span> <span class="op">*</span><span class="va">Monetary</span> <span class="va">Policy</span><span class="op">,</span> <span class="va">Inflation</span><span class="op">,</span> <span class="va">and</span> <span class="va">the</span> <span class="va">Business</span> <span class="va">Cycle</span><span class="op">*</span> — <span class="va">NK</span> <span class="va">textbook</span></span>
<span id="cb9-855"><a href="#cb9-855"></a></span>
<span id="cb9-856"><a href="#cb9-856"></a>## <span class="va">Medium</span><span class="op">-</span><span class="va">Scale</span> <span class="va">Models</span></span>
<span id="cb9-857"><a href="#cb9-857"></a><span class="op">-</span> <span class="op">**</span><span class="va">Smets</span> <span class="op">&amp;</span> <span class="va">Wouters</span> (<span class="fl">2003</span><span class="op">,</span> <span class="fl">2007</span>)<span class="op">**</span> <span class="st">"An Estimated DSGE Model"</span> — <span class="va">Benchmark</span> <span class="va">estimated</span> <span class="va">NK</span></span>
<span id="cb9-858"><a href="#cb9-858"></a><span class="op">-</span> <span class="op">**</span><span class="va">Christiano</span><span class="op">,</span> <span class="va">Eichenbaum</span> <span class="op">&amp;</span> <span class="va">Evans</span> (<span class="fl">2005</span>)<span class="op">**</span> <span class="st">"Nominal Rigidities"</span> <span class="va">JPE</span> — <span class="va">CEE</span> <span class="va">model</span></span>
<span id="cb9-859"><a href="#cb9-859"></a></span>
<span id="cb9-860"><a href="#cb9-860"></a>## <span class="va">Solution</span> <span class="va">Methods</span></span>
<span id="cb9-861"><a href="#cb9-861"></a><span class="op">-</span> <span class="op">**</span><span class="va">Uhlig</span> (<span class="fl">1999</span>)<span class="op">**</span> <span class="st">"A Toolkit for Analysing Nonlinear Dynamic Stochastic Models"</span> — <span class="va">Perturbation</span></span>
<span id="cb9-862"><a href="#cb9-862"></a><span class="op">-</span> <span class="op">**</span><span class="va">Sims</span> (<span class="fl">2002</span>)<span class="op">**</span> <span class="st">"Solving Linear Rational Expectations Models"</span> — <span class="va">QZ</span> <span class="va">decomposition</span></span>
<span id="cb9-863"><a href="#cb9-863"></a></span>
<span id="cb9-864"><a href="#cb9-864"></a>## <span class="va">Calibration</span></span>
<span id="cb9-865"><a href="#cb9-865"></a><span class="op">-</span> <span class="op">**</span><span class="va">Cooley</span> <span class="op">&amp;</span> <span class="va">Prescott</span> (<span class="fl">1995</span>)<span class="op">**</span> <span class="st">"Economic Growth and Business Cycles"</span> — <span class="va">Calibration</span> <span class="va">methodology</span></span>
<span id="cb9-866"><a href="#cb9-866"></a><span class="op">-</span> <span class="op">**</span><span class="va">Chari</span><span class="op">,</span> <span class="va">Kehoe</span> <span class="op">&amp;</span> <span class="va">McGrattan</span> (<span class="fl">2007</span>)<span class="op">**</span> <span class="st">"Business Cycle Accounting"</span> <span class="va">Econometrica</span> — <span class="va">Wedges</span> <span class="va">approach</span></span>
<span id="cb9-867"><a href="#cb9-867"></a></span>
<span id="cb9-868"><a href="#cb9-868"></a>## <span class="va">Software</span></span>
<span id="cb9-869"><a href="#cb9-869"></a><span class="op">-</span> <span class="op">**</span><span class="va">Adjemian</span> <span class="va">et</span> <span class="va">al</span><span class="op">.**</span> <span class="st">"Dynare"</span> — <span class="va">Standard</span> <span class="va">DSGE</span> <span class="va">solver</span></span>
<span id="cb9-870"><a href="#cb9-870"></a><span class="op">-</span> <span class="op">**</span><span class="va">Herbst</span> <span class="op">&amp;</span> <span class="va">Schorfheide</span> (<span class="fl">2016</span>)<span class="op">**</span> <span class="op">*</span><span class="va">Bayesian</span> <span class="va">Estimation</span> <span class="va">of</span> <span class="va">DSGE</span> <span class="va">Models</span><span class="op">*</span> — <span class="va">Modern</span> <span class="va">estimation</span></span>
</code></pre></div><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Mastering Empirical Macroeconometrics by Bijoy Ratan Ghosh</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/bijoyratanghosh/empirical-macro-curriculum/edit/main/chapters/10_dsge_foundations.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/bijoyratanghosh/empirical-macro-curriculum/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
<p>Built with <a href="https://quarto.org/">Quarto</a></p>
</div>
  </div>
</footer>




</body></html>